<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Documentation</title>

    <link href="../stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="../stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
      <script src="../javascripts/all_nosearch.js" type="text/javascript"></script>

  </head>

  <body class="includes includes_CHANGELOG">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="../images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="../images/logo.png" />
      <div id="toc">
      </div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="changelog">Changelog</h1>

<h2 id="1-3-0">1.3.0</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>Use <code class="prettyprint">objection.raw</code> instead of <code class="prettyprint">knex.raw</code> in <code class="prettyprint">Model.raw</code>. <a href="https://github.com/Vincit/objection.js/issues/1077">#1077</a></li>
<li>Allow modifiers (namedFilters) to be used in <code class="prettyprint">modifyEager</code> too.</li>
<li>Add <code class="prettyprint">underscoreBeforeDigits</code> option for snake case converters. <a href="https://github.com/Vincit/objection.js/issues/1025">#1025</a></li>
<li>fix <a href="https://github.com/Vincit/objection.js/issues/1074">#1074</a></li>
<li>Typing fixes</li>
</ul>

<h2 id="1-2-3">1.2.3</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>fix <a href="https://github.com/Vincit/objection.js/issues/1007">#1007</a></li>
<li>fix <a href="https://github.com/Vincit/objection.js/issues/1008">#1008</a></li>
<li>fix <a href="https://github.com/Vincit/objection.js/issues/1047">#1047</a></li>
</ul>

<h2 id="1-2-2">1.2.2</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>Improve reference cycle detection in <code class="prettyprint">upsertGraph</code></li>
</ul>

<h2 id="1-2-1">1.2.1</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>fix <a href="https://github.com/Vincit/objection.js/issues/1009">#1009</a></li>
</ul>

<h2 id="1-2-0">1.2.0</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>fix <a href="https://github.com/Vincit/objection.js/issues/919">#919</a></li>
<li>fix <a href="https://github.com/Vincit/objection.js/issues/964">#964</a></li>
<li>Add <code class="prettyprint">aliasFor</code> method to public API</li>
<li>Prevent bluebird warnings</li>
<li>UPPER_SNAKE_CASE support for <code class="prettyprint">snakeCaseMappers</code> and <code class="prettyprint">knexSnakeCaseMappers</code></li>
</ul>

<h2 id="1-1-10">1.1.10</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>Nothing! the npm release was somehow borked. This was just a rerelease of 1.1.9.</li>
</ul>

<h2 id="1-1-9">1.1.9</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>fix <a href="https://github.com/Vincit/objection.js/issues/782">#782</a></li>
</ul>

<h2 id="1-1-8">1.1.8</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>fix <a href="https://github.com/Vincit/objection.js/issues/909">#909</a></li>
</ul>

<h2 id="1-1-7">1.1.7</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>fix <a href="https://github.com/Vincit/objection.js/issues/884">#884</a></li>
</ul>

<h2 id="1-1-6">1.1.6</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>Add typings for fetchTableMetadata, tableMetadata and onbuildknex</li>
</ul>

<h2 id="1-1-5">1.1.5</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>Make <a href="#fetchtablemetadata">Model.fetchTableMetadata</a> and <a href="#tablemetadata">Model.tableMetadata</a> methods public. <a href="https://github.com/Vincit/objection.js/issues/871">#871</a></li>
<li>Add <a href="#onbuildknex">onBuildKnex</a> query builder hook. <a href="https://github.com/Vincit/objection.js/issues/807">#807</a></li>
</ul>

<h2 id="1-1-4">1.1.4</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>fix subquery bug causing incompatibility with knex 0.14.5 and sqlite3</li>
</ul>

<h2 id="1-1-3">1.1.3</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>fix regression in 1.1.2 (sorry about this) <a href="https://github.com/Vincit/objection.js/issues/869">#869</a></li>
</ul>

<h2 id="1-1-2">1.1.2</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>Add <code class="prettyprint">virtuals</code> option for <code class="prettyprint">toJSON</code> and <code class="prettyprint">$toJson</code> <a href="https://github.com/Vincit/objection.js/issues/866">#866</a></li>
<li>fix <a href="https://github.com/Vincit/objection.js/issues/868">#868</a></li>
</ul>

<h2 id="1-1-1">1.1.1</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>fix <a href="https://github.com/Vincit/objection.js/issues/865">#865</a></li>
<li>fix bug where the static <code class="prettyprint">Model.relatedQuery</code> didn&rsquo;t use the relation name as an alias for the table. This may break
code if you have explicitly referenced the subquery table. <a href="https://github.com/Vincit/objection.js/issues/859">#859</a></li>
</ul>

<h2 id="1-1-0">1.1.0</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>Optional <a href="#relationexpression-object-notation">object notation</a> for relation expressions.</li>
<li>fix <a href="https://github.com/Vincit/objection.js/issues/855">#855</a></li>
<li>fix <a href="https://github.com/Vincit/objection.js/issues/858">#858</a></li>
</ul>

<h2 id="1-0-1">1.0.1</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>Added public <a href="#relation">Relation.joinModelClass</a> accessor</li>
<li>Don&rsquo;t call <code class="prettyprint">returning</code> on sqlite (prevents a warning message added in knex 0.14.4)</li>
<li>fix <a href="https://github.com/Vincit/objection.js/issues/844">#844</a></li>
<li>Small documentation updates</li>
<li>Small typing fixes end updates</li>
</ul>

<h2 id="1-0-0">1.0.0 ðŸŽ‰</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>The static <a href="#relatedquery"><code class="prettyprint">relatedQuery</code></a> method.</li>
<li>New reflection methods:
<a href="#isfind"><code class="prettyprint">isFind</code></a>,
<a href="#isinsert"><code class="prettyprint">isInsert</code></a>,
<a href="#isupdate"><code class="prettyprint">isUpdate</code></a>,
<a href="#isdelete"><code class="prettyprint">isDelete</code></a>,
<a href="#isrelate"><code class="prettyprint">isRelate</code></a>,
<a href="#isunrelate"><code class="prettyprint">isUnrelate</code></a>,
<a href="#haswheres"><code class="prettyprint">hasWheres</code></a>,
<a href="#hasselects"><code class="prettyprint">hasSelects</code></a>,
<a href="#haseager"><code class="prettyprint">hasEager</code></a>,
<a href="#has"><code class="prettyprint">has</code></a>.
<a href="#clear"><code class="prettyprint">clear</code></a>.
<a href="#columnnametopropertyname"><code class="prettyprint">columnNameToPropertyName</code></a>,
<a href="#propertynametocolumnname"><code class="prettyprint">propertyNameToColumnName</code></a>.</li>
<li><code class="prettyprint">ManyToMany</code> extras now work consistently in queries and filters. <a href="https://github.com/Vincit/objection.js/issues/760">#760</a></li>
</ul>

<h3 id="breaking-changes">Breaking changes</h3>

<ul>
<li><p><code class="prettyprint">modelInstance.$query().delete().returning(something)</code> now returns a single instance instead of an array. <a href="https://github.com/Vincit/objection.js/issues/659">#659</a></p></li>
<li><p>Node 6.0.0 is now the minimum. Objection will not work on node &lt; 6.0.0.</p></li>
<li><p><a href="#validationerror"><code class="prettyprint">ValidationError</code></a> overhaul. This is a big one, so read this carefully! There are three things to check when you migrate to 1.0:</p>

<ol>
<li>The <a href="#createvalidationerror"><code class="prettyprint">createValidationError</code></a> and <a href="#validationerror"><code class="prettyprint">ValidationError</code></a> interfaces have changed.
If you have overridden the <code class="prettyprint">createValidationError</code> method in your project, or you create custom <code class="prettyprint">ValidationError</code> instances
you need migrate to the interfaces.</li>
<li>The model validation errors (jsonSchema violations) have remained pretty much the same but there are couple of differences. Before, the
keys of <code class="prettyprint">error.data</code> were property names even when a nested object in a graph failed a validation. Now the keys for nested
validation errors are key paths like <code class="prettyprint">foo.bar[2].spam</code>. Another tiny difference is the order of validation errors for each key in
<code class="prettyprint">error.data</code>. Let&rsquo;s say a property <code class="prettyprint">spam</code> failed for your model and <code class="prettyprint">error.data.spam</code> contains an array of objects that describe
the failures. Before, the first failed validation was the last item in the array, now it is the first item.</li>
<li>All <a href="#validationerror"><code class="prettyprint">ValidationErrors</code></a> now have a <code class="prettyprint">type</code> field. Before all <a href="#validationerror"><code class="prettyprint">ValidationErrors</code></a> but the model
validation errors (errors like &ldquo;invalid relation expression&rdquo;, or &ldquo;cyclic model graph&rdquo;) had no type, and could only be identified
based on the existence of some weird key in <code class="prettyprint">error.data</code>. The <code class="prettyprint">error.data</code> is now removed from those errors and the <code class="prettyprint">type</code> should be
used instead. The message from the data is now stored in <code class="prettyprint">error.message</code>.</li>
</ol></li>
<li><p>Removed deprecated methods <code class="prettyprint">whereRef</code>, <code class="prettyprint">whereJsonField</code> and <code class="prettyprint">whereJsonEquals</code>. The <a href="#ref"><code class="prettyprint">ref</code></a> helper can be used to replace the
<code class="prettyprint">whereRef</code> calls. <a href="#ref"><code class="prettyprint">ref</code></a> and <a href="#lit"><code class="prettyprint">lit</code></a> can be used to replace the removed json methods.</p></li>
<li><p><code class="prettyprint">ManyToMany</code> extras now work consistently in queries and filters. <a href="https://github.com/Vincit/objection.js/issues/760">#760</a>. This is not
a breaking change per se, but can cause some queries to fail with a &ldquo;ambiguous identifier&rdquo; error because the join table is now joined
in places where it previously wasn&rsquo;t. You need to explicitly specify the table for those failing columns using <code class="prettyprint">Table.theColumn</code> syntax.</p></li>
</ul>

<h3 id="changes">Changes</h3>

<ul>
<li><code class="prettyprint">isFindQuery</code> is renamed to <a href="http://vincit.github.io/objection.js/#isfind"><code class="prettyprint">isFind</code></a> and deprecated.</li>
</ul>

<h2 id="0-9-4">0.9.4</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>Fixed <a href="https://github.com/Vincit/objection.js/issues/627">#627</a></li>
<li>Fixed <a href="https://github.com/Vincit/objection.js/issues/671">#671</a></li>
<li>Fixed <a href="https://github.com/Vincit/objection.js/issues/672">#672</a></li>
<li>Fixed <a href="https://github.com/Vincit/objection.js/issues/674">#674</a></li>
</ul>

<h2 id="0-9-3">0.9.3</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>Add beforeInsert hook for relations. <a href="https://github.com/Vincit/objection.js/issues/649">#649</a> <a href="https://github.com/Vincit/objection.js/issues/19">#19</a></li>
<li>Add <a href="#relatedfindquerymutates"><code class="prettyprint">relatedFindQueryMutates</code></a> and <a href="#relatedinsertquerymutates"><code class="prettyprint">relatedInsertQueryMutates</code></a> configs as well as <a href="#_s_setrelated"><code class="prettyprint">$setRelated</code></a> and <a href="#_s_appendrelated"><code class="prettyprint">$appendRelated</code></a> helpers. <a href="https://github.com/Vincit/objection.js/issues/599">#599</a></li>
<li>Fixed <a href="https://github.com/Vincit/objection.js/issues/648">#648</a></li>
</ul>

<h2 id="0-9-2">0.9.2</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>Fix regression: <code class="prettyprint">from</code> fails with a subquery.</li>
</ul>

<h2 id="0-9-1">0.9.1</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li><a href="http://vincit.github.io/objection.js/#castto"><code class="prettyprint">castTo</code></a> method for setting the model class of query result rows.</li>
<li><a href="http://vincit.github.io/objection.js/#onerror"><code class="prettyprint">onError</code></a> <code class="prettyprint">QueryBuilder</code> method.</li>
<li><a href="http://vincit.github.io/objection.js/#objection-knexsnakecasemappers"><code class="prettyprint">knexSnakeCaseMappers</code></a> and <a href="http://vincit.github.io/objection.js/#objection-snakecasemappers"><code class="prettyprint">snakeCaseMappers</code></a> for snake_case to camelCase conversions.</li>
</ul>

<h2 id="0-9-0">0.9.0</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>Relations can now be defined using keys inside JSON columns. See the examples <a href="http://vincit.github.io/objection.js/#relationmappings">here</a>.</li>
<li><a href="http://vincit.github.io/objection.js/#lit"><code class="prettyprint">lit</code></a> helper function <a href="https://github.com/Vincit/objection.js/issues/275">#275</a></li>
<li>Fixes for <a href="http://vincit.github.io/objection.js/#upsertgraph"><code class="prettyprint">upsertGraph</code></a> when using composite keys. <a href="https://github.com/Vincit/objection.js/issues/517">#517</a></li>
<li>Added <code class="prettyprint">noDelete</code>, <code class="prettyprint">noUpdate</code>, <code class="prettyprint">noInsert</code>, <code class="prettyprint">noRelate</code> and <code class="prettyprint">noUnrelate</code> options for <code class="prettyprint">upsertGraph</code>. See <a href="#upsertgraphoptions">UpsertGraphOptions docs</a> for more info.</li>
<li><code class="prettyprint">insertGraph</code> now accepts an options object just like <code class="prettyprint">upsertGraph</code>. <code class="prettyprint">relate</code> option can be used instead of <code class="prettyprint">#dbRef</code>. <a href="https://github.com/Vincit/objection.js/issues/586">#586</a></li>
</ul>

<h3 id="breaking-changes">Breaking changes</h3>

<ul>
<li><p>Instance update/patch with <code class="prettyprint">returning</code> now return a single object instead of an array. <a href="https://github.com/Vincit/objection.js/issues/423">#423</a></p></li>
<li><p>Because of the support for JSON relations <a href="http://vincit.github.io/objection.js/#relation">the <code class="prettyprint">Relation</code> class</a>
has changed a bit.</p></li>
</ul>

<h2 id="0-8-8">0.8.8</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>Typing updates: <a href="https://github.com/Vincit/objection.js/issues/489">#489</a> <a href="https://github.com/Vincit/objection.js/issues/487">#487</a></li>
<li>Improve <code class="prettyprint">resultSize</code> method. <a href="https://github.com/Vincit/objection.js/issues/213">#213</a></li>
<li>Avoid unnecessary updates in upsertGraph <a href="https://github.com/Vincit/objection.js/issues/480">#480</a></li>
</ul>

<h2 id="0-8-7">0.8.7</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li><code class="prettyprint">throwIfNotFound</code> now also throws when update or delete doesn&rsquo;t change any rows.</li>
<li><a href="#mixin"><code class="prettyprint">mixin</code></a> and <a href="#compose"><code class="prettyprint">compose</code></a> helpers for applying multiple plugins. <a href="https://github.com/Vincit/objection.js/issues/475">#475</a> <a href="https://github.com/Vincit/objection.js/issues/473">#473</a></li>
<li>Typing updates <a href="https://github.com/Vincit/objection.js/issues/474">#474</a> <a href="https://github.com/Vincit/objection.js/issues/479">#479</a></li>
<li><code class="prettyprint">upsertGraph</code> now validates patched models correctly. <a href="https://github.com/Vincit/objection.js/issues/477">#477</a></li>
</ul>

<h2 id="0-8-6">0.8.6</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>Finally: the first version of <a href="#graph-upserts"><code class="prettyprint">upsertGraph</code></a> method! Please open issues about bugs, WTFs and missing features.</li>
<li>Strip readonly virtual properties in fromJson &amp; friends <a href="https://github.com/Vincit/objection.js/issues/432">#432</a></li>
<li>Fixed <a href="https://github.com/Vincit/objection.js/issues/439">#439</a></li>
</ul>

<h2 id="0-8-5">0.8.5</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>Add <a href="http://vincit.github.io/objection.js/#uselimitinfirst"><code class="prettyprint">Model.useLimitInFirst</code></a> configuration flag.</li>
</ul>

<h2 id="0-8-4">0.8.4</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>New shorthand methods <a href="http://vincit.github.io/objection.js/#joineager"><code class="prettyprint">joinEager</code></a>, <a href="http://vincit.github.io/objection.js/#naiveeager"><code class="prettyprint">naiveEager</code></a>,
<a href="http://vincit.github.io/objection.js/#mergejoineager"><code class="prettyprint">mergeJoinEager</code></a> and <a href="http://vincit.github.io/objection.js/#mergenaiveeager"><code class="prettyprint">mergeNaiveEager</code></a>.</li>
<li>New shorthand method <a href="http://vincit.github.io/objection.js/#findone"><code class="prettyprint">findOne</code></a></li>
<li>New reflection method <a href="http://vincit.github.io/objection.js/#isfind"><code class="prettyprint">isFindQuery</code></a></li>
<li>ManyToMany extra properties can now be updated <a href="https://github.com/Vincit/objection.js/issues/413">#413</a></li>
</ul>

<h2 id="0-8-3">0.8.3</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li><a href="http://vincit.github.io/objection.js/#eager"><code class="prettyprint">NaiveEagerAlogrithm</code></a></li>
<li><a href="http://vincit.github.io/objection.js/#relationexpression">Aliases in relation expressions</a> <a href="https://github.com/Vincit/objection.js/issues/402">#402</a></li>
<li>New lazily evaluated <code class="prettyprint">raw</code> function. <a href="https://github.com/Vincit/objection.js/issues/275">#275</a></li>
</ul>

<h2 id="0-8-2">0.8.2</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li><a href="http://vincit.github.io/objection.js/#namedfilters"><code class="prettyprint">Model.namedFilters</code></a> object for defining shared filters that can be used by name in eager expressions.</li>
<li>Full support for views and table aliases in eager, join, joinRelation etc. <a href="https://github.com/Vincit/objection.js/issues/181">#181</a></li>
<li>Fix <code class="prettyprint">bindTransaction</code> bug with <code class="prettyprint">ManyToManyRelation</code> junction tables <a href="https://github.com/Vincit/objection.js/issues/395">#395</a></li>
</ul>

<h2 id="0-8-1">0.8.1</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li><a href="http://vincit.github.io/objection.js/#throwifnotfound"><code class="prettyprint">throwIfNotFound</code></a> method for making empty query results throw an exception.</li>
<li>fix error when passing model instance to a <code class="prettyprint">where</code> method. <a href="https://github.com/Vincit/objection.js/issues/387">#387</a></li>
</ul>

<h2 id="0-8-0">0.8.0</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>All query methods now call <code class="prettyprint">Model.query</code> to create a <code class="prettyprint">QueryBuilder</code> instance <a href="https://github.com/Vincit/objection.js/issues/346">#346</a></li>
<li>Objection is no longer transpiled. One of the implications is that you can use a github
link in package.json to test experimental versions.</li>
<li><code class="prettyprint">count</code> can now be called without arguments <a href="https://github.com/Vincit/objection.js/issues/364">#364</a></li>
<li>A new <a href="#getrelations"><code class="prettyprint">getRelations</code></a> method for plugin development and other reflection greatness.</li>
</ul>

<h3 id="breaking-changes">Breaking changes</h3>

<blockquote>
<p>Old model definition</p>
</blockquote>
<pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">Person</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">Model</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">Model</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Person</span><span class="p">);</span>

<span class="nx">Person</span><span class="p">.</span><span class="nx">tableName</span> <span class="o">=</span> <span class="s1">'Person'</span><span class="p">;</span>

<span class="nx">Person</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">fullName</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">firstName</span> <span class="o">+</span> <span class="s1">' '</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastName</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// More static and prototype methods.</span>
</code></pre>
<blockquote>
<p>Easiest way to migrate to <code class="prettyprint">class</code> and <code class="prettyprint">extends</code> keywords</p>
</blockquote>
<pre class="highlight javascript"><code><span class="kr">class</span> <span class="nx">Person</span> <span class="kr">extends</span> <span class="nx">Model</span> <span class="p">{</span>

<span class="p">}</span>

<span class="nx">Person</span><span class="p">.</span><span class="nx">tableName</span> <span class="o">=</span> <span class="s1">'Person'</span><span class="p">;</span>

<span class="nx">Person</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">fullName</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">firstName</span> <span class="o">+</span> <span class="s1">' '</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastName</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// More static and prototype methods.</span>
</code></pre>
<ul>
<li><p>Support for node versions below 4.0.0 has been removed. With it the support for legacy class inheritance using <code class="prettyprint">Model.extend</code> method
has also been removed. This means that you need to change your model definitions to use the <code class="prettyprint">class</code> and <code class="prettyprint">extends</code> keywords.
To achieve this with the minimum amount of changes you can simply swap the constructor function and <code class="prettyprint">Model.extend</code> to
a class definition. You can still define all static and prototype methods and properties the old way. See the example on the right &ndash;&gt;</p>

<p>Note that this also affects Babel transpilation. You cannot (or need to) use <code class="prettyprint">babel-plugin-transform-es2015-classes</code> anymore.
See the <a href="https://github.com/Vincit/objection.js/tree/master/examples/express-es7">ESNext example project</a> as an example of
how to setup babel.</p></li>
<li><p>The default value of <a href="#pickjsonschemaproperties"><code class="prettyprint">pickJsonSchemaProperties</code></a> was changed to <code class="prettyprint">false</code>. Before, all properties that
were not listed in <code class="prettyprint">jsonSchema</code> were removed before <code class="prettyprint">insert</code>, <code class="prettyprint">patch</code> or <code class="prettyprint">update</code> (if <code class="prettyprint">jsonSchma</code> was defined). Starting from
this version you need to explicitly set the value to <code class="prettyprint">true</code>. You may have been used this feature by accident.
If you have weird problems after the update, try setting <code class="prettyprint">objection.Model.pickJsonSchemaProperties = true;</code> to see
if it helps.</p></li>
<li><p><a href="#pickjsonschemaproperties"><code class="prettyprint">relate</code></a> and <a href="#pickjsonschemaproperties"><code class="prettyprint">unrelate</code></a> methods now return the result of the
underlying query (<code class="prettyprint">patch</code> in case of <code class="prettyprint">HasManyRelation</code>, <code class="prettyprint">HasOneRelation</code>, and <code class="prettyprint">BelongsToOneRelation</code>. <code class="prettyprint">insert</code> otherwise).
Before the method input was always returned.</p></li>
<li><p><code class="prettyprint">Model.RelatedQueryBuilder</code> is removed. <code class="prettyprint">Model.QueryBuilder</code> is now used to create all query builders for the model.
This only affects you if you have defined custom query builders.</p></li>
</ul>

<h2 id="0-7-12">0.7.12</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>fix <a href="https://github.com/Vincit/objection.js/issues/345">#345</a></li>
</ul>

<h2 id="0-7-11">0.7.11</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>fix <a href="https://github.com/Vincit/objection.js/issues/339">#339</a></li>
<li>fix <a href="https://github.com/Vincit/objection.js/issues/341">#341</a></li>
</ul>

<h2 id="0-7-10">0.7.10</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>fix bugs that prevented using <code class="prettyprint">$relatedQuery</code> and <code class="prettyprint">eager</code> together with <code class="prettyprint">JoinEagerAlgorithm</code></li>
<li>typing updates</li>
</ul>

<h2 id="0-7-9">0.7.9</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li><a href="http://vincit.github.io/objection.js/#joinrelation"><code class="prettyprint">joinRelation</code></a> now accepts <a href="http://vincit.github.io/objection.js/#relationexpression"><code class="prettyprint">RelationExpressions</code></a> and can join multiple and nested relations.</li>
</ul>

<h2 id="0-7-6">0.7.6</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li><code class="prettyprint">range</code> and <code class="prettyprint">page</code> methods now use a window function and only generate one query on postgresql <a href="https://github.com/Vincit/objection.js/issues/62">#62</a></li>
<li>fix MSSQL 2100 parameter limit in eager queries <a href="https://github.com/Vincit/objection.js/issues/311">#311</a></li>
</ul>

<h2 id="0-7-5">0.7.5</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>fix <a href="https://github.com/Vincit/objection.js/issues/327">#327</a></li>
<li>fix <a href="https://github.com/Vincit/objection.js/issues/256">#256</a></li>
</ul>

<h2 id="0-7-4">0.7.4</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>automatically select columns needed for relations <a href="https://github.com/Vincit/objection.js/issues/309">#309</a></li>
<li>fix an issue where <code class="prettyprint">$formatJson</code> was called inside <code class="prettyprint">insertGraph</code> <a href="https://github.com/Vincit/objection.js/issues/326">#326</a></li>
</ul>

<h2 id="0-7-3">0.7.3</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>fix <a href="https://github.com/Vincit/objection.js/issues/325">#325</a></li>
<li>fix an issue where <code class="prettyprint">select</code> had to be used in addition to <code class="prettyprint">distinct</code> in some cases</li>
</ul>

<h2 id="0-7-2">0.7.2</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li><code class="prettyprint">HasOneThroughRelation</code> relation type.</li>
</ul>

<h2 id="0-7-1">0.7.1</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>fix <code class="prettyprint">JoinEagerAlgorithm</code> NPE bug</li>
</ul>

<h2 id="0-7-0">0.7.0</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li><code class="prettyprint">jsonSchema</code> without <code class="prettyprint">properties</code> now works. <a href="https://github.com/Vincit/objection.js/issues/205">#205</a></li>
<li><code class="prettyprint">relationMappings</code> can now be a function. <a href="https://github.com/Vincit/objection.js/issues/227">#227</a></li>
<li>many to many extras can now be aliased. <a href="https://github.com/Vincit/objection.js/issues/223">#223</a></li>
<li>zero values are now allowed in relation columns. <a href="https://github.com/Vincit/objection.js/issues/228">#228</a></li>
<li>active transaction can now be accessed in <code class="prettyprint">$before/$after</code> hooks through <code class="prettyprint">queryContext.transaction</code> property.</li>
<li>Validation can now be easily modified through a new <a href="#validator"><code class="prettyprint">Validator</code></a> interface. <a href="https://github.com/Vincit/objection.js/issues/241">#241</a> <a href="https://github.com/Vincit/objection.js/issues/199">#199</a></li>
<li>fix a <code class="prettyprint">JoinEager</code> problem where an empty result for a relation caused the following relations to be empty. <a href="https://github.com/Vincit/objection.js/issues/292">#292</a></li>
<li><code class="prettyprint">ref(fieldExpression)</code> syntax to reduce need for knex.raw and updating single attribute inside JSON column. <a href="https://github.com/Vincit/objection.js/issues/270">#270</a></li>
<li><a href="http://vincit.github.io/objection.js/#mergeeager">mergeEager</a> method.</li>
</ul>

<h3 id="breaking-changes">Breaking changes</h3>

<ul>
<li><code class="prettyprint">$relatedQuery</code> now returns a single model instead of an array for belongsToOne and hasOne relations. <a href="https://github.com/Vincit/objection.js/issues/155">#155</a></li>
<li>identifier of a model can now be updated. Be careful with this one! Before if you forgot a wrong id in an <code class="prettyprint">update</code>/<code class="prettyprint">patch</code> operation, it would simply get ignored. Now the id is also updated just like any other column <a href="https://github.com/Vincit/objection.js/issues/100">#100</a></li>
<li><code class="prettyprint">Table.*</code> is now selected by default in all queries instead of <code class="prettyprint">*</code>. This will break some join queries that don&rsquo;t have an explicit select clause. <a href="https://github.com/Vincit/objection.js/issues/161">#161</a></li>
<li><code class="prettyprint">ValidationError.data</code> is now an object including, for each key, a list of errors with context info. <a href="https://github.com/Vincit/objection.js/issues/283">#283</a></li>
</ul>

<h2 id="0-6-2">0.6.2</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li><code class="prettyprint">relationMappings</code> can now be a function <a href="https://github.com/Vincit/objection.js/issues/227">#227</a></li>
</ul>

<h2 id="0-6-1">0.6.1</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>fix bug <a href="https://github.com/Vincit/objection.js/issues/205">#205</a></li>
</ul>

<h2 id="0-6-0">0.6.0</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>Eager loading can now be done using joins and zero extra queries. See <a href="#eageralgorithm"><code class="prettyprint">eagerAlgorithm</code></a>, <a href="#defaulteageralgorithm"><code class="prettyprint">defaultEagerAlgorithm</code></a> and <a href="#eager"><code class="prettyprint">eager</code></a> for more info.</li>
<li><code class="prettyprint">#ref</code> in graph inserts can now contain extra properties for many-to-many relations <a href="https://github.com/Vincit/objection.js/issues/156">#156</a></li>
<li><code class="prettyprint">#dbRef</code> can now be used to refer to existing rows from a <code class="prettyprint">insertWithRelated</code> graph.</li>
<li><a href="#modelpaths"><code class="prettyprint">modelPaths</code></a> attribute for cleaner way to point to models in relationMappings.</li>
<li><a href="#pickjsonschemaproperties"><code class="prettyprint">pickJsonSchemaProperties</code></a> config parameter <a href="https://github.com/Vincit/objection.js/issues/110">#110</a></li>
<li><a href="#insertgraphandfetch"><code class="prettyprint">insertGraphAndFetch</code></a> with <code class="prettyprint">insertWithRelatedAndFetch</code> alias. <a href="https://github.com/Vincit/objection.js/issues/172">#172</a></li>
<li>Added <a href="#_s_beforedelete"><code class="prettyprint">$beforeDelete</code></a> and <a href="#_s_afterdelete"><code class="prettyprint">$afterDelete</code></a> hooks <a href="https://github.com/Vincit/objection.js/issues/112">#112</a></li>
<li>Old values can now be accessed from <code class="prettyprint">$beforeUpdate</code>, <code class="prettyprint">$afterUpdate</code>, <code class="prettyprint">$beforeValidate</code> and <code class="prettyprint">$afterValidate</code> hooks <a href="https://github.com/Vincit/objection.js/issues/185">#185</a></li>
<li>Support length property <a href="ttps://github.com/Vincit/objection.js/issues/168">#168</a></li>
<li>Make sure operations are executed in the order they are called <a href="https://github.com/Vincit/objection.js/issues/180">#180</a></li>
<li>Fetch nothing if the <code class="prettyprint">where</code> clauses hit no rows in <code class="prettyprint">update/patchAndFetchById</code> methods <a href="https://github.com/Vincit/objection.js/issues/189">#189</a></li>
<li>Lots of performance tweaks.</li>
<li><code class="prettyprint">$loadRelated</code> and <code class="prettyprint">loadRelated</code> now return a <code class="prettyprint">QueryBuilder</code>.</li>
</ul>

<h3 id="breaking-changes">Breaking changes</h3>

<ul>
<li><p>Undefined values as query method arguments now throw an exception. Before they were just silently ignored
and for example <code class="prettyprint">delete().where(&#39;id&#39;, undefined)</code> caused the entire table to be deleted. <a href="http://vincit.github.io/objection.js/#skipundefined">skipUndefined</a>
method can be called for a query builder to handle the undefined values the old way.</p></li>
<li><p>Deprecated method <code class="prettyprint">dumpSql</code> is now removed.</p></li>
<li><p><code class="prettyprint">$loadRelated</code> and <code class="prettyprint">loadRelated</code> now return a <code class="prettyprint">QueryBuilder</code>. This may break your code is some rare cases
where you have called a non-standard promise method like <code class="prettyprint">reflect</code> for the return value of these functions.</p></li>
</ul>

<h2 id="0-5-5">0.5.5</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li><a href="#virtualattributes">Virtual attributes</a></li>
</ul>

<h2 id="0-5-4">0.5.4</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>bugfix: insertWithRelated now works with <code class="prettyprint">additionalProperties = false</code> in <code class="prettyprint">jsonSchema</code></li>
<li>Add updateAndFetch and patchAndFetch methods for <code class="prettyprint">$query</code></li>
<li>bugfix: afterGet was not called for nested models in eager query</li>
<li>Use ajv instad of tv4 for json schema validation</li>
</ul>

<h2 id="0-5-3">0.5.3</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>ES6 promise compatibility fixes.</li>
</ul>

<h2 id="0-5-1">0.5.1</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li><a href="#afterget">$afterGet</a> hook.</li>
</ul>

<h2 id="0-5-0">0.5.0</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li><a href="#joinrelation">joinRelation</a> family of query builder methods.</li>
<li><code class="prettyprint">HasOneRelation</code> for creating inverse one-to-one relations.</li>
<li>Relations have been renamed <code class="prettyprint">OneToOneRelation</code> &ndash;&gt; <code class="prettyprint">BelongsToOneRelation</code>, <code class="prettyprint">OneToManyRelation</code> &ndash;&gt; <code class="prettyprint">HasManyRelation</code>.
The old names work, but have been deprecated.</li>
<li><a href="#withschema">withSchema</a> now works as expected and sets the schema of all queries executed by the query builder the
method is called for.</li>
<li><a href="#filtereager">filterEager</a> method for better eager query filtering.</li>
<li><a href="#relationmappings">extra properties</a> feature for selecting/inserting columns from/to the join table in many-to-many relations.</li>
<li>Eager query recursion depth can be controlled like so: <code class="prettyprint">parent.^5</code>.</li>
</ul>

<h2 id="0-4-0">0.4.0</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>Query context feature. See <a href="https://github.com/Vincit/objection.js/issues/51">#51</a> and <a href="#context">these docs</a> for more info.</li>
<li>Composite key support.</li>
<li><a href="#findbyid">findById</a>, <a href="#deletebyid">deleteById</a>, <a href="#wherecomposite">whereComposite</a> and
<a href="#whereincomposite">whereInComposite</a> query builder methods.</li>
</ul>

<h3 id="breaking-changes">Breaking changes</h3>

<p>There shouldn&rsquo;t be any major breaking changes. We moved from ES5 to ES7 + babel in this version so there are big changes
in the codebase. If something comes up, please open an issue.</p>

<p>There are a few known corner cases that may break:</p>

<ul>
<li><p>You can now define a model for the join table of <code class="prettyprint">ManyToMany</code> relations in <code class="prettyprint">relationMappings</code>. This is optional,
but may be needed if you already have a model for a <code class="prettyprint">ManyToMany</code> relation <em>and</em> you use <code class="prettyprint">snake_case</code>
to <code class="prettyprint">camelCase</code> conversion for the column names. See the documentation on the <a href="#relationthrough">through</a>
property of <a href="#relationmappings">relationMappings</a>.</p></li>
<li><p>The repo no longer contains the actual built javascript. Only the ES7 code that is transpiled when the code is
published to npm. Therefore you can no longer specify a git hash to package.json to use for example the
HEAD version. We will start to publish alpha and RC versions to npm when something new and experimental
is added to the library.</p></li>
</ul>

<h2 id="0-3-3">0.3.3</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>fix regression: QueryBuilder.from is broken.</li>
</ul>

<h2 id="0-3-2">0.3.2</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>Improved relation expression whitespace handling.</li>
</ul>

<h2 id="0-3-1">0.3.1</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li><code class="prettyprint">whereJson*</code> methods can now be used inside functions given to <code class="prettyprint">where</code> methods.</li>
<li>Added multiple missing knex methods to <code class="prettyprint">QueryBuilder</code>.</li>
</ul>

<h2 id="0-3-0">0.3.0</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li><a href="http://vincit.github.io/objection.js/QueryBuilder.html#insertWithRelated">insertWithRelated</a> method for
inserting model trees</li>
<li><a href="http://vincit.github.io/objection.js/QueryBuilder.html#insertAndFetch">insertAndFetch</a>,
<a href="http://vincit.github.io/objection.js/QueryBuilder.html#updateAndFetchById">updateAndFetchById</a> and
<a href="http://vincit.github.io/objection.js/QueryBuilder.html#patchAndFetchById">patchAndFetchById</a> helper methods</li>
<li>Filters for <a href="#eager-queries">eager expressions</a></li>
<li><a href="#transaction-object">New alternative way to use transactions</a></li>
<li>Many performance updates related to cloning, serializing and deserializing model trees.</li>
</ul>

<h3 id="breaking-changes">Breaking changes</h3>

<ul>
<li>QueryBuilder methods <code class="prettyprint">update</code>, <code class="prettyprint">patch</code> and <code class="prettyprint">delete</code> now return the number of affected rows.
The new methods <code class="prettyprint">updateAndFetchById</code> and <code class="prettyprint">patchAndFetchById</code> may help with the migration</li>
<li><code class="prettyprint">modelInstance.$query()</code> instance method now returns a single model instead of an array</li>
<li>Removed <code class="prettyprint">Model.generateId()</code> method. <code class="prettyprint">$beforeInsert</code> can be used instead</li>
</ul>

<h2 id="0-2-8">0.2.8</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>ES6 inheritance support</li>
<li>generator function support for transactions</li>
<li>traverse,pick and omit methods for Model and QueryBuilder</li>
<li>bugfix: issue #38</li>
</ul>

<h2 id="0-2-7">0.2.7</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>bugfix: fix #37 also for <code class="prettyprint">$query()</code>.</li>
<li>Significant <code class="prettyprint">toJson</code>/<code class="prettyprint">fromJson</code> performance boost.</li>
</ul>

<h2 id="0-2-6">0.2.6</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>bugfix: fix regression bug that broke dumpSql.</li>
</ul>

<h2 id="0-2-5">0.2.5</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>bugfix: fix regression bug that prevented values assigned to <code class="prettyprint">this</code> in <code class="prettyprint">$before</code> callbacks from getting into
the actual database query</li>
</ul>

<h2 id="0-2-4">0.2.4</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>bugfix: many-to-many relations didn&rsquo;t work correctly with a snake_case to camelCase conversion
in the related model class.</li>
</ul>

<h2 id="0-2-3">0.2.3</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>Promise constructor is now exposed through <code class="prettyprint">require(&#39;objection&#39;).Promise</code>.</li>
</ul>

<h2 id="0-2-2">0.2.2</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>$beforeUpdate, $afterUpdate, $beforeInsert etc. are now asynchronous and you can return promises from them.</li>
<li>Added <code class="prettyprint">Model.fn()</code> shortcut to <code class="prettyprint">knex.fn</code>.</li>
<li>Added missing <code class="prettyprint">asCallback</code> and <code class="prettyprint">nodeify</code> methods for <code class="prettyprint">QueryBuilder</code>.</li>
</ul>

<h2 id="0-2-1">0.2.1</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>bugfix: Chaining <code class="prettyprint">insert</code> with <code class="prettyprint">returning</code> now returns all listed columns.</li>
</ul>

<h2 id="0-2-0">0.2.0</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>New name <code class="prettyprint">objection.js</code>.</li>
<li><code class="prettyprint">$beforeInsert</code>, <code class="prettyprint">$afterInsert</code>, <code class="prettyprint">$beforeUpdate</code> and <code class="prettyprint">$afterUpdate</code> hooks for <code class="prettyprint">Model</code>.</li>
<li>Postgres jsonb query methods: <code class="prettyprint">whereJsonEquals</code>, <code class="prettyprint">whereJsonSupersetOf</code>, <code class="prettyprint">whereJsonSubsetOf</code> and friends.</li>
<li><code class="prettyprint">whereRef</code> query method.</li>
<li>Expose <code class="prettyprint">knex.raw()</code> through <code class="prettyprint">Model.raw()</code>.</li>
<li>Expose <code class="prettyprint">knex.client.formatter()</code> through <code class="prettyprint">Model.formatter()</code>.</li>
<li><code class="prettyprint">QueryBuilder</code> can be used to make sub queries just like knex&rsquo;s <code class="prettyprint">QueryBuilder</code>.</li>
<li>Possibility to use a custom <code class="prettyprint">QueryBuilder</code> subclass by overriding <code class="prettyprint">Model.QueryBuilder</code>.</li>
<li>Filter queries/objects for relations.</li>
<li>A pile of bug fixes.</li>
</ul>

<h3 id="breaking-changes">Breaking changes</h3>

<ul>
<li>Project was renamed to objection.js. Migrate simply by replacing <code class="prettyprint">moron</code> with <code class="prettyprint">objection</code>.</li>
</ul>

<h2 id="0-1-0">0.1.0</h2>

<p>First release.</p>

      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
