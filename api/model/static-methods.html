<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Static Methods | Objection.js</title>
    <meta name="description" content="An SQL friendly ORM for node.js">
    
    
    <link rel="preload" href="/objection.js/assets/css/0.styles.887cf860.css" as="style"><link rel="preload" href="/objection.js/assets/js/app.76d7874a.js" as="script"><link rel="preload" href="/objection.js/assets/js/11.3c6b2d3f.js" as="script"><link rel="prefetch" href="/objection.js/assets/js/1.5a757e49.js"><link rel="prefetch" href="/objection.js/assets/js/10.e5040982.js"><link rel="prefetch" href="/objection.js/assets/js/12.a0adc759.js"><link rel="prefetch" href="/objection.js/assets/js/13.4461fb8a.js"><link rel="prefetch" href="/objection.js/assets/js/14.049c6c0d.js"><link rel="prefetch" href="/objection.js/assets/js/15.974b6934.js"><link rel="prefetch" href="/objection.js/assets/js/16.b67ecee8.js"><link rel="prefetch" href="/objection.js/assets/js/17.f592d0df.js"><link rel="prefetch" href="/objection.js/assets/js/18.831af7fb.js"><link rel="prefetch" href="/objection.js/assets/js/19.26033c58.js"><link rel="prefetch" href="/objection.js/assets/js/2.a68c0ffb.js"><link rel="prefetch" href="/objection.js/assets/js/20.9269019e.js"><link rel="prefetch" href="/objection.js/assets/js/21.b7cff5f2.js"><link rel="prefetch" href="/objection.js/assets/js/22.7f88965e.js"><link rel="prefetch" href="/objection.js/assets/js/23.9e665185.js"><link rel="prefetch" href="/objection.js/assets/js/24.308a0126.js"><link rel="prefetch" href="/objection.js/assets/js/25.a3a03667.js"><link rel="prefetch" href="/objection.js/assets/js/26.d32005fa.js"><link rel="prefetch" href="/objection.js/assets/js/27.96b7e3d6.js"><link rel="prefetch" href="/objection.js/assets/js/28.ad2b235c.js"><link rel="prefetch" href="/objection.js/assets/js/29.ea32909d.js"><link rel="prefetch" href="/objection.js/assets/js/3.3b545222.js"><link rel="prefetch" href="/objection.js/assets/js/30.70314878.js"><link rel="prefetch" href="/objection.js/assets/js/31.297a65c0.js"><link rel="prefetch" href="/objection.js/assets/js/32.9d1fee39.js"><link rel="prefetch" href="/objection.js/assets/js/33.ac59f7de.js"><link rel="prefetch" href="/objection.js/assets/js/34.7a25b716.js"><link rel="prefetch" href="/objection.js/assets/js/35.21b9a764.js"><link rel="prefetch" href="/objection.js/assets/js/36.6ed7b4b1.js"><link rel="prefetch" href="/objection.js/assets/js/37.6d5cadc0.js"><link rel="prefetch" href="/objection.js/assets/js/38.c1da4d24.js"><link rel="prefetch" href="/objection.js/assets/js/39.92e5fb0d.js"><link rel="prefetch" href="/objection.js/assets/js/40.fde289e2.js"><link rel="prefetch" href="/objection.js/assets/js/41.2b79b225.js"><link rel="prefetch" href="/objection.js/assets/js/42.0dc92f75.js"><link rel="prefetch" href="/objection.js/assets/js/43.82df3128.js"><link rel="prefetch" href="/objection.js/assets/js/44.7e1ec74f.js"><link rel="prefetch" href="/objection.js/assets/js/45.63984838.js"><link rel="prefetch" href="/objection.js/assets/js/46.064524bd.js"><link rel="prefetch" href="/objection.js/assets/js/47.ab004518.js"><link rel="prefetch" href="/objection.js/assets/js/48.c7862da0.js"><link rel="prefetch" href="/objection.js/assets/js/49.3daa6199.js"><link rel="prefetch" href="/objection.js/assets/js/50.fa5a2dd4.js"><link rel="prefetch" href="/objection.js/assets/js/51.95f37a23.js"><link rel="prefetch" href="/objection.js/assets/js/6.b7dcf886.js"><link rel="prefetch" href="/objection.js/assets/js/7.1bd89ba3.js"><link rel="prefetch" href="/objection.js/assets/js/8.13201fc0.js"><link rel="prefetch" href="/objection.js/assets/js/9.7c9786ad.js"><link rel="prefetch" href="/objection.js/assets/js/vendors~docsearch.22f43628.js">
    <link rel="stylesheet" href="/objection.js/assets/css/0.styles.887cf860.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/objection.js/" class="home-link router-link-active"><!----> <span class="site-name">Objection.js</span></a> <div class="links" style="max-width:nullpx;"><form id="search-form" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/objection.js/guide/" class="nav-link">Guide</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">API Reference</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/objection.js/api/objection/" class="nav-link">Main Module</a></li><li class="dropdown-item"><!----> <a href="/objection.js/api/query-builder/" class="nav-link">Query Builder</a></li><li class="dropdown-item"><!----> <a href="/objection.js/api/model/" class="nav-link router-link-active">Model</a></li><li class="dropdown-item"><!----> <a href="/objection.js/api/types/" class="nav-link">Types</a></li></ul></div></div><div class="nav-item"><a href="/objection.js/recipes/" class="nav-link">Recipe Book</a></div><div class="nav-item"><a href="/objection.js/changelog/" class="nav-link">Changelog</a></div><div class="nav-item"><a href="https://github.com/vincit/objection.js" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ⭐ Star
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/vincit/objection.js" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/objection.js/guide/" class="nav-link">Guide</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">API Reference</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/objection.js/api/objection/" class="nav-link">Main Module</a></li><li class="dropdown-item"><!----> <a href="/objection.js/api/query-builder/" class="nav-link">Query Builder</a></li><li class="dropdown-item"><!----> <a href="/objection.js/api/model/" class="nav-link router-link-active">Model</a></li><li class="dropdown-item"><!----> <a href="/objection.js/api/types/" class="nav-link">Types</a></li></ul></div></div><div class="nav-item"><a href="/objection.js/recipes/" class="nav-link">Recipe Book</a></div><div class="nav-item"><a href="/objection.js/changelog/" class="nav-link">Changelog</a></div><div class="nav-item"><a href="https://github.com/vincit/objection.js" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ⭐ Star
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/vincit/objection.js" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Model API Reference</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/objection.js/api/model/overview.html" class="sidebar-link">Overview</a></li><li><a href="/objection.js/api/model/static-properties.html" class="sidebar-link">Static Properties</a></li><li><a href="/objection.js/api/model/static-methods.html" class="active sidebar-link">Static Methods</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-query" class="sidebar-link">static query()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-relatedquery" class="sidebar-link">static relatedQuery()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-knex" class="sidebar-link">static knex()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-bindknex" class="sidebar-link">static bindKnex()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-bindtransaction" class="sidebar-link">static bindTransaction()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-fromjson" class="sidebar-link">static fromJson()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-fromdatabasejson" class="sidebar-link">static fromDatabaseJson()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-modifiernotfound" class="sidebar-link">static modifierNotFound()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-createvalidator" class="sidebar-link">static createValidator()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-createnotfounderror" class="sidebar-link">static createNotFoundError()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-createvalidationerror" class="sidebar-link">static createValidationError()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-loadrelated" class="sidebar-link">static loadRelated()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-traverseasync" class="sidebar-link">static traverseAsync()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-getrelations" class="sidebar-link">static getRelations()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-columnnametopropertyname" class="sidebar-link">static columnNameToPropertyName()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-propertynametocolumnname" class="sidebar-link">static propertyNameToColumnName()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-fetchtablemetadata" class="sidebar-link">static fetchTableMetadata()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-tablemetadata" class="sidebar-link">static tableMetadata()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-raw" class="sidebar-link">static raw()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-fn" class="sidebar-link">static fn()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-knexquery" class="sidebar-link">static knexQuery()</a></li></ul></li><li><a href="/objection.js/api/model/instance-methods.html" class="sidebar-link">Instance Methods</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="static-methods"><a href="#static-methods" aria-hidden="true" class="header-anchor">#</a> Static Methods</h1> <h2 id="static-query"><a href="#static-query" aria-hidden="true" class="header-anchor">#</a> <code>static</code> query()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> queryBuilder <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>transactionOrKnex<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Creates a query builder for the model's table.</p> <p>All query builders are created using this function, including <code>$query</code>, <code>$relatedQuery</code> and <code>relatedQuery</code>. That means you can modify each query by overriding this method for your model class.</p> <p>See the <a href="/objection.js/guide/query-examples.html">query examples</a> section for more examples.</p> <h4 id="arguments"><a href="#arguments" aria-hidden="true" class="header-anchor">#</a> Arguments</h4> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>transactionOrKnex</td> <td>object</td> <td>Optional transaction or knex instance for the query. This can be used to specify a transaction or even a different database. for a query. Falsy values are ignored.</td></tr></tbody></table> <h4 id="return-value"><a href="#return-value" aria-hidden="true" class="header-anchor">#</a> Return value</h4> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/">QueryBuilder</a></td> <td>The created query builder</td></tr></tbody></table> <h4 id="examples"><a href="#examples" aria-hidden="true" class="header-anchor">#</a> Examples</h4> <p>Read models from the database:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Get all rows.</span>
<span class="token keyword">const</span> people <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'there are'</span><span class="token punctuation">,</span> people<span class="token punctuation">.</span>length<span class="token punctuation">,</span> <span class="token string">'people in the database'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Example of a more complex WHERE clause. This generates:</span>
<span class="token comment">// SELECT &quot;persons&quot;.*</span>
<span class="token comment">// FROM &quot;persons&quot;</span>
<span class="token comment">// WHERE (&quot;firstName&quot; = 'Jennifer' AND &quot;age&quot; &lt; 30)</span>
<span class="token comment">// OR (&quot;firstName&quot; = 'Mark' AND &quot;age&quot; &gt; 30)</span>
<span class="token keyword">const</span> marksAndJennifers <span class="token operator">=</span> <span class="token keyword">await</span> Person
  <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token parameter">builder</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    builder
      <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'firstName'</span><span class="token punctuation">,</span> <span class="token string">'Jennifer'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'&lt;'</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">orWhere</span><span class="token punctuation">(</span><span class="token parameter">builder</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    builder
      <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'firstName'</span><span class="token punctuation">,</span> <span class="token string">'Mark'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'&gt;'</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>marksAndJennifers<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">// Get a subset of rows and fetch related models</span>
<span class="token comment">// for each row.</span>
<span class="token keyword">const</span> oldPeople <span class="token operator">=</span> <span class="token keyword">await</span> Person
  <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'&gt;'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">eager</span><span class="token punctuation">(</span><span class="token string">'children.children.movies'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'some old person\'s grand child has appeared in'</span><span class="token punctuation">,</span>
  oldPeople<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>movies<span class="token punctuation">.</span>length<span class="token punctuation">,</span>
  <span class="token string">'movies'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Insert models to the database:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> sylvester <span class="token operator">=</span> <span class="token keyword">await</span> Person
  <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span>firstName<span class="token punctuation">:</span> <span class="token string">'Sylvester'</span><span class="token punctuation">,</span> lastName<span class="token punctuation">:</span> <span class="token string">'Stallone'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sylvester<span class="token punctuation">.</span><span class="token function">fullName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// --&gt; 'Sylvester Stallone'.</span>

<span class="token comment">// Batch insert. This only works on Postgresql as it is</span>
<span class="token comment">// the only database that returns the identifiers of</span>
<span class="token comment">// _all_ inserted rows. If you need to do batch inserts</span>
<span class="token comment">// on other databases useknex* directly.</span>
<span class="token comment">// (See .knexQuery() method).</span>
<span class="token keyword">const</span> inserted <span class="token operator">=</span> <span class="token keyword">await</span> Person
  <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>firstName<span class="token punctuation">:</span> <span class="token string">'Arnold'</span><span class="token punctuation">,</span> lastName<span class="token punctuation">:</span> <span class="token string">'Schwarzenegger'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>firstName<span class="token punctuation">:</span> <span class="token string">'Sylvester'</span><span class="token punctuation">,</span> lastName<span class="token punctuation">:</span> <span class="token string">'Stallone'</span><span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>inserted<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">fullName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// --&gt; 'Arnold Schwarzenegger'</span>
</code></pre></div><p><code>update</code> and <code>patch</code> can be used to update models. Only difference between the mentioned methods is that <code>update</code> validates the input objects using the model class's full jsonSchema and <code>patch</code> ignores the <code>required</code> property of the schema. Use <code>update</code> when you want to update <em>all</em> properties of a model and <code>patch</code> when only a subset should be updated.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> numUpdatedRows <span class="token operator">=</span> <span class="token keyword">await</span> Person
  <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span>firstName<span class="token punctuation">:</span> <span class="token string">'Jennifer'</span><span class="token punctuation">,</span> lastName<span class="token punctuation">:</span> <span class="token string">'Lawrence'</span><span class="token punctuation">,</span> age<span class="token punctuation">:</span> <span class="token number">35</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span> jennifer<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>numUpdatedRows<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// This will throw assuming that `firstName` or `lastName`</span>
<span class="token comment">// is a required property for a Person.</span>
<span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span>age<span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// This will _not_ throw.</span>
<span class="token keyword">await</span> Person
  <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">patch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>age<span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Everyone is now 100 years old'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Models can be deleted using the delete method. Naturally the delete query can be chained with any knex* methods:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">await</span> Person
  <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'&gt;'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'anyone over 90 is now removed from the database'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="static-relatedquery"><a href="#static-relatedquery" aria-hidden="true" class="header-anchor">#</a> <code>static</code> relatedQuery()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> queryBuilder <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">relatedQuery</span><span class="token punctuation">(</span>relationName<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Creates a subquery for a relation.</p> <p>This query can only be used as a subquery and therefore there is no need to ever pass a transaction or a knex instance to it. It will always inherit its parent query's transaction because it is compiled and executed as a part of the parent query.</p> <p>See the examples below. There are also more examples in the <a href="/objection.js/recipes/relation-subqueries.html">Relation Subqueries recipe</a>.</p> <h5 id="arguments-2"><a href="#arguments-2" aria-hidden="true" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>relationName</td> <td>string</td> <td>The name of the relation to create subquery for.</td></tr></tbody></table> <h5 id="return-value-2"><a href="#return-value-2" aria-hidden="true" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/">QueryBuilder</a></td> <td>The created query builder</td></tr></tbody></table> <h5 id="examples-2"><a href="#examples-2" aria-hidden="true" class="header-anchor">#</a> Examples</h5> <p>Select count of a relation and the maximum value of another one:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> people <span class="token operator">=</span> <span class="token keyword">await</span> Person
  <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token string">'persons.*'</span><span class="token punctuation">,</span>

    Person<span class="token punctuation">.</span><span class="token function">relatedQuery</span><span class="token punctuation">(</span><span class="token string">'pets'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'species'</span><span class="token punctuation">,</span> <span class="token string">'dog'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">as</span><span class="token punctuation">(</span><span class="token string">'dogCount'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

    Person<span class="token punctuation">.</span><span class="token function">relatedQuery</span><span class="token punctuation">(</span><span class="token string">'movies'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token string">'createdAt'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">as</span><span class="token punctuation">(</span><span class="token string">'mostRecentMovieDate'</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>people<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>people<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dogCount<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>people<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mostRecentMovieDate<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Find models that have at least one item in a relation:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> peopleThatHavePets <span class="token operator">=</span> <span class="token keyword">await</span> Person
  <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">whereExists</span><span class="token punctuation">(</span>Person<span class="token punctuation">.</span><span class="token function">relatedQuery</span><span class="token punctuation">(</span><span class="token string">'pets'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Generates something like this:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token string">&quot;persons&quot;</span><span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">from</span> <span class="token string">&quot;persons&quot;</span>
<span class="token keyword">where</span> <span class="token keyword">exists</span> <span class="token punctuation">(</span>
  <span class="token keyword">select</span> <span class="token string">&quot;pets&quot;</span><span class="token punctuation">.</span><span class="token operator">*</span>
  <span class="token keyword">from</span> <span class="token string">&quot;animals&quot;</span> <span class="token keyword">as</span> <span class="token string">&quot;pets&quot;</span>
  <span class="token keyword">where</span> <span class="token string">&quot;pets&quot;</span><span class="token punctuation">.</span><span class="token string">&quot;ownerId&quot;</span> <span class="token operator">=</span> <span class="token string">&quot;persons&quot;</span><span class="token punctuation">.</span><span class="token string">&quot;id&quot;</span>
<span class="token punctuation">)</span>
</code></pre></div><h2 id="static-knex"><a href="#static-knex" aria-hidden="true" class="header-anchor">#</a> <code>static</code> knex()</h2> <p>Get/Set the knex instance for a model class.</p> <p>Subclasses inherit the connection. A system-wide knex instance can thus be set by calling <code>objection.Model.knex(knex)</code>. This works even after subclasses have been created.</p> <p>If you want to use multiple databases, you can instead pass the knex instance to each individual query or use the <a href="/objection.js/api/model/static-methods.html#static-bindknex">bindKnex</a> method.</p> <h5 id="examples-3"><a href="#examples-3" aria-hidden="true" class="header-anchor">#</a> Examples</h5> <p>Set a knex instance:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> knex <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'knex'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  client<span class="token punctuation">:</span> <span class="token string">'sqlite3'</span><span class="token punctuation">,</span>
  connection<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    filename<span class="token punctuation">:</span> <span class="token string">'database.db'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Model<span class="token punctuation">.</span><span class="token function">knex</span><span class="token punctuation">(</span>knex<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Get the knex instance:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> knex <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">knex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="static-bindknex"><a href="#static-bindknex" aria-hidden="true" class="header-anchor">#</a> <code>static</code> bindKnex()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> BoundPerson <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">bindKnex</span><span class="token punctuation">(</span>transactionOrKnex<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Creates an anonymous model subclass class that is bound to the given knex instance or transaction.</p> <p>This method can be used to bind a Model subclass to multiple databases for example in a multi-tenant system. See the <a href="/objection.js/recipes/multitenancy-using-multiple-databases.html">multi tenancy recipe</a> for more info.</p> <p>Also check out the the <a href="/objection.js/guide/transactions.html#binding-models-to-a-transaction">model binding pattern for transactions</a> which internally uses <code>bindKnex</code>.</p> <h5 id="arguments-3"><a href="#arguments-3" aria-hidden="true" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>transactionOrKnex</td> <td>object</td> <td>knex instance or a transaction to bind the model to.</td></tr></tbody></table> <h5 id="return-value-3"><a href="#return-value-3" aria-hidden="true" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>Constructor&lt;? extends Model&gt;</td> <td>The created model subclass constructor</td></tr></tbody></table> <h5 id="examples-4"><a href="#examples-4" aria-hidden="true" class="header-anchor">#</a> Examples</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> knex1 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'knex'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  client<span class="token punctuation">:</span> <span class="token string">'sqlite3'</span><span class="token punctuation">,</span>
  connection<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    filename<span class="token punctuation">:</span> <span class="token string">'database1.db'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> knex2 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'knex'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  client<span class="token punctuation">:</span> <span class="token string">'sqlite3'</span><span class="token punctuation">,</span>
  connection<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    filename<span class="token punctuation">:</span> <span class="token string">'database2.db'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

SomeModel<span class="token punctuation">.</span><span class="token function">knex</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> BoundModel1 <span class="token operator">=</span> SomeModel<span class="token punctuation">.</span><span class="token function">bindKnex</span><span class="token punctuation">(</span>knex1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> BoundModel2 <span class="token operator">=</span> SomeModel<span class="token punctuation">.</span><span class="token function">bindKnex</span><span class="token punctuation">(</span>knex2<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Throws since the knex instance is null.</span>
<span class="token keyword">await</span> SomeModel<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Works.</span>
<span class="token keyword">const</span> models <span class="token operator">=</span> <span class="token keyword">await</span> BoundModel1<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>models<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">instanceof</span> <span class="token class-name">SomeModel</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// --&gt; true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>models<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">instanceof</span> <span class="token class-name">BoundModel1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// --&gt; true</span>

<span class="token comment">// Works.</span>
<span class="token keyword">const</span> models <span class="token operator">=</span> <span class="token keyword">await</span> BoundModel2<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>models<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">instanceof</span> <span class="token class-name">SomeModel</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// --&gt; true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>models<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">instanceof</span> <span class="token class-name">BoundModel2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// --&gt; true</span>
</code></pre></div><h2 id="static-bindtransaction"><a href="#static-bindtransaction" aria-hidden="true" class="header-anchor">#</a> <code>static</code> bindTransaction()</h2> <p>Alias for <a href="/objection.js/api/model/static-methods.html#static-bindknex">bindKnex</a>.</p> <h5 id="examples-5"><a href="#examples-5" aria-hidden="true" class="header-anchor">#</a> Examples</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> transaction <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'objection'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Person <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./models/Person'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">await</span> <span class="token function">transaction</span><span class="token punctuation">(</span>Person<span class="token punctuation">.</span><span class="token function">knex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">trx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> TransactingPerson <span class="token operator">=</span>  Person<span class="token punctuation">.</span><span class="token function">bindTransaction</span><span class="token punctuation">(</span>trx<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">await</span> TransactingPerson
    <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span>firstName<span class="token punctuation">:</span> <span class="token string">'Jennifer'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> TransactingPerson
    <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">patch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>lastName<span class="token punctuation">:</span> <span class="token string">'Lawrence'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span> jennifer<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This is 100% equivalent to the example above:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> transaction <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'objection'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Person <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./models/Person'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">await</span> <span class="token function">transaction</span><span class="token punctuation">(</span>Person<span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">TransactingPerson</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> TransactingPerson
    <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span>firstName<span class="token punctuation">:</span> <span class="token string">'Jennifer'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> TransactingPerson
    <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">patch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>lastName<span class="token punctuation">:</span> <span class="token string">'Lawrence'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span> jennifer<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="static-fromjson"><a href="#static-fromjson" aria-hidden="true" class="header-anchor">#</a> <code>static</code> fromJson()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> person <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">fromJson</span><span class="token punctuation">(</span>json<span class="token punctuation">,</span> opt<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Creates a model instance from a POJO (Plain Old Javascript Object).</p> <p>The object is checked against <a href="/objection.js/api/model/static-properties.html#static-jsonschema">jsonSchema</a> if a schema is provided and an exception is thrown on failure.</p> <p>The <code>json</code> object is also passed through the <a href="/objection.js/api/model/instance-methods.html#parsejson">$parseJson</a> hook before the model instance is created. See <a href="/objection.js/api/model/overview.html#model-data-lifecycle">this section</a> for more info.</p> <h5 id="arguments-4"><a href="#arguments-4" aria-hidden="true" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>json</td> <td>Object</td> <td>The JSON object from which to create the model.</td></tr> <tr><td>opt</td> <td><a href="/objection.js/api/types/#type-modeloptions">ModelOptions</a></td> <td>Update options.</td></tr></tbody></table> <h5 id="return-value-4"><a href="#return-value-4" aria-hidden="true" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/model/" class="router-link-active">Model</a></td> <td>The created model instance</td></tr></tbody></table> <h5 id="examples-6"><a href="#examples-6" aria-hidden="true" class="header-anchor">#</a> Examples</h5> <p>Create a model instance:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> jennifer <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">fromJson</span><span class="token punctuation">(</span><span class="token punctuation">{</span> firstName<span class="token punctuation">:</span> <span class="token string">'Jennifer'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Create a model instance skipping validation:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> jennifer <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">fromJson</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span> firstName<span class="token punctuation">:</span> <span class="token string">'Jennifer'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> skipValidation<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre></div><h2 id="static-fromdatabasejson"><a href="#static-fromdatabasejson" aria-hidden="true" class="header-anchor">#</a> <code>static</code> fromDatabaseJson()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> person <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">fromDatabaseJson</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Creates a model instance from a JSON object send by the database driver.</p> <p>Unlike <a href="/objection.js/api/model/static-methods.html#static-fromjson">fromJson</a>, this method doesn't validate the input. The input is expected to be in the database format as explained <a href="/objection.js/api/model/overview.html#model-data-lifecycle">here</a>.</p> <h5 id="arguments-5"><a href="#arguments-5" aria-hidden="true" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>row</td> <td>Object</td> <td>A database row.</td></tr></tbody></table> <h5 id="return-value-5"><a href="#return-value-5" aria-hidden="true" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/model/" class="router-link-active">Model</a></td> <td>The created model instance</td></tr></tbody></table> <h2 id="static-modifiernotfound"><a href="#static-modifiernotfound" aria-hidden="true" class="header-anchor">#</a> <code>static</code> modifierNotFound()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">BaseModel</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">modifierNotFound</span><span class="token punctuation">(</span><span class="token parameter">builder<span class="token punctuation">,</span> modifier</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> properties <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>jsonSchema
    <span class="token keyword">if</span> <span class="token punctuation">(</span>properties <span class="token operator">&amp;&amp;</span> modifier <span class="token keyword">in</span> properties<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      builder<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>modifier<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">modifierNotFound</span><span class="token punctuation">(</span>builder<span class="token punctuation">,</span> modifier<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Handles modifiers that are not recognized by the various mechanisms that can specify
them, such as <a href="/objection.js/api/query-builder/other-methods.html#modify">modify</a> and <a href="/objection.js/api/query-builder/other-methods.html#applymodifier">applyModifier</a>, as well as the use of modifiers in eager expressions (see <a href="/objection.js/api/types/#type-relationexpression">RelationExpression</a>) and in relations (see <a href="/objection.js/api/types/#type-relationmapping">RelationMapping</a>).</p> <p>By default, the static <code>modifierNotFound()</code> hook throws a <code>ModifierNotFoundError</code> error. If a model class overrides the hook, it can decide to handle the modifer through the passed <code>builder</code> instance, or call the hook's definition in the super class to still throw the error.</p> <h5 id="arguments-6"><a href="#arguments-6" aria-hidden="true" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>builder</td> <td><a href="/objection.js/api/query-builder/">QueryBuilder</a></td> <td>The query builder on which to apply the modifier.</td></tr> <tr><td>modifier</td> <td>string</td> <td>The name of the unknown modifier.</td></tr></tbody></table> <h2 id="static-createvalidator"><a href="#static-createvalidator" aria-hidden="true" class="header-anchor">#</a> <code>static</code> createValidator()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">BaseModel</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">createValidator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MyCustomValidator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Creates an instance of a <a href="/objection.js/api/types/#class-validator">Validator</a> that is used to do all validation related stuff. This method is called only once per model class.</p> <p>You can override this method to return an instance of your custom validator. The custom validator doesn't need to be based on the <code>jsonSchema</code>. It can be anything at all as long as it implements the <a href="/objection.js/api/types/#class-validator">Validator</a> interface.</p> <p>If you want to use the default json schema based <a href="/objection.js/api/types/#class-ajvvalidator">AjvValidator</a> but want to modify it, you can use the <code>objection.AjvValidator</code> constructor. See the default implementation example.</p> <p>If you want to share the same validator instance between multiple models, that's completely fine too. Simply implement <code>createValidator</code> so that it always returns the same object instead of creating a new one.</p> <h5 id="examples-7"><a href="#examples-7" aria-hidden="true" class="header-anchor">#</a> Examples</h5> <p>Sharing the same validator between model classes is also possible:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> validator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyCustomValidator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">BaseModel</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">createValidator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> validator<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The default implementation:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> AjvValidator <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'objection'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>AjvValidator<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">createValidator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">AjvValidator</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token function-variable function">onCreateAjv</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">ajv</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// Here you can modify the `Ajv` instance.</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        allErrors<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        validateSchema<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        ownProperties<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        v5<span class="token punctuation">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="static-createnotfounderror"><a href="#static-createnotfounderror" aria-hidden="true" class="header-anchor">#</a> <code>static</code> createNotFoundError()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">BaseModel</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">createNotFoundError</span><span class="token punctuation">(</span><span class="token parameter">queryContext</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MyCustomNotFoundError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Creates an error thrown by <a href="/objection.js/api/query-builder/other-methods.html#throwifnotfound">throwIfNotFound</a> method. You can override this
to throw any error you want.</p> <h5 id="arguments-7"><a href="#arguments-7" aria-hidden="true" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>queryContext</td> <td>Object</td> <td>The context object of query that produced the empty result. See <a href="/objection.js/api/query-builder/other-methods.html#context">context</a>.</td></tr></tbody></table> <h5 id="return-value-6"><a href="#return-value-6" aria-hidden="true" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><code>Error</code></td> <td>The created error. <a href="/objection.js/api/types/#class-notfounderror">NotFoundError</a> by default.</td></tr></tbody></table> <h5 id="examples-8"><a href="#examples-8" aria-hidden="true" class="header-anchor">#</a> Examples</h5> <p>The default implementation:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">createNotFoundError</span><span class="token punctuation">(</span><span class="token parameter">queryContext</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>NotFoundError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="static-createvalidationerror"><a href="#static-createvalidationerror" aria-hidden="true" class="header-anchor">#</a> <code>static</code> createValidationError()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">BaseModel</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">createValidationError</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> type<span class="token punctuation">,</span> message<span class="token punctuation">,</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MyCustomValidationError</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">,</span> message<span class="token punctuation">,</span> data <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Creates an error thrown when validation fails for a model. You can override this to throw any error you want. The errors created by this function don't have to implement any interface or have the same properties as <code>ValidationError</code>. Objection only throws errors created by this function an never catches them.</p> <h5 id="return-value-7"><a href="#return-value-7" aria-hidden="true" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><code>Error</code></td> <td>The created error. <a href="/objection.js/api/types/#class-validationerror">ValidationError</a> by default.</td></tr></tbody></table> <h2 id="static-loadrelated"><a href="#static-loadrelated" aria-hidden="true" class="header-anchor">#</a> <code>static</code> loadRelated()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> queryBuilder <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">loadRelated</span><span class="token punctuation">(</span>
  models<span class="token punctuation">,</span>
  expression<span class="token punctuation">,</span>
  modifiers<span class="token punctuation">,</span>
  transactionOrKnex
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Load related models for a set of models using a <a href="/objection.js/api/types/#type-relationexpression">RelationExpression</a>.</p> <h5 id="arguments-8"><a href="#arguments-8" aria-hidden="true" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>models</td> <td>Array&lt;<a href="/objection.js/api/model/" class="router-link-active">Model</a>|Object&gt;</td> <td>Model instances for which to fetch the relations. Can be an array of model instances, array of POJOs, a single model instance or a single POJO.</td></tr> <tr><td>expression</td> <td>string|<a href="/objection.js/api/types/#type-relationexpression">RelationExpression</a></td> <td>The relation expression</td></tr> <tr><td>modifiers</td> <td>Object&lt;string, function(<a href="/objection.js/api/query-builder/">QueryBuilder</a>)&gt;</td> <td>Optional modifiers</td></tr> <tr><td>transactionOrKnex</td> <td>object</td> <td>Optional transaction or knex instance for the query. This can be used to specify a transaction or even a different database.</td></tr></tbody></table> <h5 id="return-value-8"><a href="#return-value-8" aria-hidden="true" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/">QueryBuilder</a></td> <td>The created query builder</td></tr></tbody></table> <h5 id="examples-9"><a href="#examples-9" aria-hidden="true" class="header-anchor">#</a> Examples</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> people <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">loadRelated</span><span class="token punctuation">(</span><span class="token punctuation">[</span>person1<span class="token punctuation">,</span> person2<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'children.pets'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> person1 <span class="token operator">=</span> people<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> person2 <span class="token operator">=</span> people<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>Relations can be filtered by giving modifier functions as arguments to the relations:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> people <span class="token operator">=</span> <span class="token keyword">await</span> Person
  <span class="token punctuation">.</span><span class="token function">loadRelated</span><span class="token punctuation">(</span><span class="token punctuation">[</span>person1<span class="token punctuation">,</span> person2<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token string">`
    children(orderByAge).[
      pets(onlyDogs, orderByName),
      movies
    ]
  `</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function">orderByAge</span><span class="token punctuation">(</span><span class="token parameter">builder</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      builder<span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token function">orderByName</span><span class="token punctuation">(</span><span class="token parameter">builder</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      builder<span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token function">onlyDogs</span><span class="token punctuation">(</span><span class="token parameter">builder</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      builder<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'species'</span><span class="token punctuation">,</span> <span class="token string">'dog'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>people<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>children<span class="token punctuation">.</span>pets<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="static-traverseasync"><a href="#static-traverseasync" aria-hidden="true" class="header-anchor">#</a> <code>static</code> traverseAsync()</h2> <p>Traverses the relation tree of a model instance (or a list of model instances).</p> <p>Calls the callback for each related model recursively. The callback is called also for the input models themselves.</p> <p>In the second example the traverser function is only called for <code>Person</code> instances.</p> <h5 id="arguments-9"><a href="#arguments-9" aria-hidden="true" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>filterConstructor</td> <td>function</td> <td>If this optional constructor is given, the <code>traverser</code> is only called for models for which <code>model instanceof filterConstructor</code> returns true.</td></tr> <tr><td>models</td> <td><a href="/objection.js/api/model/" class="router-link-active">Model</a>|<a href="/objection.js/api/model/" class="router-link-active">Model</a>[]</td> <td>The model(s) whose relation trees to traverse.</td></tr> <tr><td>traverser</td> <td>function(<a href="/objection.js/api/model/" class="router-link-active">Model</a>, string, string)</td> <td>The traverser function that is called for each model. The first argument is the model itself. If the model is in a relation of some other model the second argument is the parent model and the third argument is the name of the relation.</td></tr></tbody></table> <h5 id="examples-10"><a href="#examples-10" aria-hidden="true" class="header-anchor">#</a> Examples</h5> <p>There are two ways to call this method:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> models <span class="token operator">=</span> <span class="token keyword">await</span> SomeModel<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">await</span> Model<span class="token punctuation">.</span><span class="token function">traverseAsync</span><span class="token punctuation">(</span>models<span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">model<span class="token punctuation">,</span> parentModel<span class="token punctuation">,</span> relationName</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> <span class="token function">doSomething</span><span class="token punctuation">(</span>model<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>and</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> persons <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

Model<span class="token punctuation">.</span><span class="token function">traverseAsync</span><span class="token punctuation">(</span>Person<span class="token punctuation">,</span> persons<span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">person<span class="token punctuation">,</span> parentModel<span class="token punctuation">,</span> relationName</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> <span class="token function">doSomethingWithPerson</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Also works with a single model instance</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">traverseAsync</span><span class="token punctuation">(</span>person<span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">model<span class="token punctuation">,</span> parentModel<span class="token punctuation">,</span> relationName</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> <span class="token function">doSomething</span><span class="token punctuation">(</span>model<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="static-getrelations"><a href="#static-getrelations" aria-hidden="true" class="header-anchor">#</a> <code>static</code> getRelations()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> relations <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">getRelations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Returns a <a href="/objection.js/api/types/#class-relation">Relation</a> object for each relation defined in <a href="/objection.js/api/model/static-properties.html#static-relationmappings">relationMappings</a>.</p> <p>This method is mainly useful for plugin developers and for other generic usages.</p> <h5 id="return-value-9"><a href="#return-value-9" aria-hidden="true" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>Object&lt;string, <a href="/objection.js/api/types/#class-relation">Relation</a>&gt;</td> <td>Object whose keys are relation names and values are <a href="/objection.js/api/types/#class-relation">Relation</a> instances.</td></tr></tbody></table> <h2 id="static-columnnametopropertyname"><a href="#static-columnnametopropertyname" aria-hidden="true" class="header-anchor">#</a> <code>static</code> columnNameToPropertyName()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> propertyName <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">columnNameToPropertyName</span><span class="token punctuation">(</span>columnName<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Runs the property through possible <code>columnNameMappers</code> and <code>$parseDatabaseJson</code> hooks to apply any possible conversion for the column name.</p> <h5 id="arguments-10"><a href="#arguments-10" aria-hidden="true" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>columnName</td> <td>string</td> <td>A column name</td></tr></tbody></table> <h5 id="return-value-10"><a href="#return-value-10" aria-hidden="true" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>string</td> <td>The property name</td></tr></tbody></table> <h5 id="examples-11"><a href="#examples-11" aria-hidden="true" class="header-anchor">#</a> Examples</h5> <p>If you have defined <code>columnNameMappers = snakeCaseMappers()</code> for your model:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> propName <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">columnNameToPropertyName</span><span class="token punctuation">(</span><span class="token string">'foo_bar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>propName<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// --&gt; 'fooBar'</span>
</code></pre></div><h2 id="static-propertynametocolumnname"><a href="#static-propertynametocolumnname" aria-hidden="true" class="header-anchor">#</a> <code>static</code> propertyNameToColumnName()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> columnName <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">propertyNameToColumnName</span><span class="token punctuation">(</span>propertyName<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Runs the property through possible <code>columnNameMappers</code> and <code>$formatDatabaseJson</code> hooks to apply any possible conversion for the property name.</p> <h5 id="arguments-11"><a href="#arguments-11" aria-hidden="true" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>propertyName</td> <td>string</td> <td>A property name</td></tr></tbody></table> <h5 id="return-value-11"><a href="#return-value-11" aria-hidden="true" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>string</td> <td>The column name</td></tr></tbody></table> <h5 id="examples-12"><a href="#examples-12" aria-hidden="true" class="header-anchor">#</a> Examples</h5> <p>If you have defined <code>columnNameMappers = snakeCaseMappers()</code> for your model:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> columnName <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">propertyNameToColumnName</span><span class="token punctuation">(</span><span class="token string">'fooBar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>columnName<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// --&gt; 'foo_bar'</span>
</code></pre></div><h2 id="static-fetchtablemetadata"><a href="#static-fetchtablemetadata" aria-hidden="true" class="header-anchor">#</a> <code>static</code> fetchTableMetadata()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> metadata <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">fetchTableMetadata</span><span class="token punctuation">(</span>opt<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Fetches and caches the table metadata.</p> <p>Most of the time objection doesn't need this metadata, but some methods like <a href="/objection.js/api/query-builder/eager-methods.html#joineager">joinEager</a> do. This method is called by objection when the metadata is needed. The result is cached and after the first call the cached promise is returned and no queries are executed.</p> <p>Because objection uses this on demand, the first query that needs this information can have unpredicable performance. If that's a problem, you can call this method for each of your models during your app's startup.</p> <p>If you've implemented <a href="/objection.js/api/model/static-methods.html#static-tablemetadata">tableMetadata</a> method to return a custom metadata object, this method doesn't execute database queries, but returns <code>Promise.resolve(this.tableMetadata())</code> instead.</p> <h5 id="arguments-12"><a href="#arguments-12" aria-hidden="true" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>opt</td> <td><a href="/objection.js/api/types/#type-tablemetadatafetchoptions">TableMetadataFetchOptions</a></td> <td>Optional options</td></tr></tbody></table> <h5 id="return-value-12"><a href="#return-value-12" aria-hidden="true" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>Promise&lt;<a href="/objection.js/api/types/#type-tablemetadata">TableMetadata</a>&gt;</td> <td>The table metadata object</td></tr></tbody></table> <h2 id="static-tablemetadata"><a href="#static-tablemetadata" aria-hidden="true" class="header-anchor">#</a> <code>static</code> tableMetadata()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> metadata <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">tableMetadata</span><span class="token punctuation">(</span>opt<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Synchronously returns the table metadata object from the cache.</p> <p>You can override this method to return a custom object if you don't want objection to use
<a href="/objection.js/api/model/static-methods.html#static-fetchtablemetadata">fetchTableMetadata</a>.</p> <p>See <a href="/objection.js/api/model/static-methods.html#static-fetchtablemetadata">fetchTableMetadata</a> for more information.</p> <h5 id="arguments-13"><a href="#arguments-13" aria-hidden="true" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>opt</td> <td><a href="/objection.js/api/types/#type-tablemetadataoptions">TableMetadataOptions</a></td> <td>Optional options</td></tr></tbody></table> <h5 id="return-value-13"><a href="#return-value-13" aria-hidden="true" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/types/#type-tablemetadata">TableMetadata</a></td> <td>The table metadata object</td></tr></tbody></table> <h5 id="examples-13"><a href="#examples-13" aria-hidden="true" class="header-anchor">#</a> Examples</h5> <p>A custom override that uses the property information in <code>jsonSchema</code>.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">tableMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      columns<span class="token punctuation">:</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>jsonSchema<span class="token punctuation">.</span>properties<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="static-raw"><a href="#static-raw" aria-hidden="true" class="header-anchor">#</a> <code>static</code> raw()</h2> <p>Shortcut for <code>Person.knex().raw(...args)</code></p> <h2 id="static-fn"><a href="#static-fn" aria-hidden="true" class="header-anchor">#</a> <code>static</code> fn()</h2> <p>Shortcut for <code>Person.knex().fn</code></p> <h2 id="static-knexquery"><a href="#static-knexquery" aria-hidden="true" class="header-anchor">#</a> <code>static</code> knexQuery()</h2> <p>Shortcut for <code>Person.knex().table(Person.tableName)</code></p></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/objection.js/api/model/static-properties.html" class="prev">
          Static Properties
        </a></span> <span class="next"><a href="/objection.js/api/model/instance-methods.html">
          Instance Methods
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/objection.js/assets/js/app.76d7874a.js" defer></script><script src="/objection.js/assets/js/11.3c6b2d3f.js" defer></script>
  </body>
</html>
