<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Eager Methods | Objection.js</title>
    <meta name="description" content="An SQL friendly ORM for node.js">
    
    
    <link rel="preload" href="/objection.js/assets/css/0.styles.887cf860.css" as="style"><link rel="preload" href="/objection.js/assets/js/app.76d7874a.js" as="script"><link rel="preload" href="/objection.js/assets/js/15.974b6934.js" as="script"><link rel="prefetch" href="/objection.js/assets/js/1.5a757e49.js"><link rel="prefetch" href="/objection.js/assets/js/10.e5040982.js"><link rel="prefetch" href="/objection.js/assets/js/11.3c6b2d3f.js"><link rel="prefetch" href="/objection.js/assets/js/12.a0adc759.js"><link rel="prefetch" href="/objection.js/assets/js/13.4461fb8a.js"><link rel="prefetch" href="/objection.js/assets/js/14.049c6c0d.js"><link rel="prefetch" href="/objection.js/assets/js/16.b67ecee8.js"><link rel="prefetch" href="/objection.js/assets/js/17.f592d0df.js"><link rel="prefetch" href="/objection.js/assets/js/18.831af7fb.js"><link rel="prefetch" href="/objection.js/assets/js/19.26033c58.js"><link rel="prefetch" href="/objection.js/assets/js/2.a68c0ffb.js"><link rel="prefetch" href="/objection.js/assets/js/20.9269019e.js"><link rel="prefetch" href="/objection.js/assets/js/21.b7cff5f2.js"><link rel="prefetch" href="/objection.js/assets/js/22.7f88965e.js"><link rel="prefetch" href="/objection.js/assets/js/23.9e665185.js"><link rel="prefetch" href="/objection.js/assets/js/24.308a0126.js"><link rel="prefetch" href="/objection.js/assets/js/25.a3a03667.js"><link rel="prefetch" href="/objection.js/assets/js/26.d32005fa.js"><link rel="prefetch" href="/objection.js/assets/js/27.96b7e3d6.js"><link rel="prefetch" href="/objection.js/assets/js/28.ad2b235c.js"><link rel="prefetch" href="/objection.js/assets/js/29.ea32909d.js"><link rel="prefetch" href="/objection.js/assets/js/3.3b545222.js"><link rel="prefetch" href="/objection.js/assets/js/30.70314878.js"><link rel="prefetch" href="/objection.js/assets/js/31.297a65c0.js"><link rel="prefetch" href="/objection.js/assets/js/32.9d1fee39.js"><link rel="prefetch" href="/objection.js/assets/js/33.ac59f7de.js"><link rel="prefetch" href="/objection.js/assets/js/34.7a25b716.js"><link rel="prefetch" href="/objection.js/assets/js/35.21b9a764.js"><link rel="prefetch" href="/objection.js/assets/js/36.6ed7b4b1.js"><link rel="prefetch" href="/objection.js/assets/js/37.6d5cadc0.js"><link rel="prefetch" href="/objection.js/assets/js/38.c1da4d24.js"><link rel="prefetch" href="/objection.js/assets/js/39.92e5fb0d.js"><link rel="prefetch" href="/objection.js/assets/js/40.fde289e2.js"><link rel="prefetch" href="/objection.js/assets/js/41.2b79b225.js"><link rel="prefetch" href="/objection.js/assets/js/42.0dc92f75.js"><link rel="prefetch" href="/objection.js/assets/js/43.82df3128.js"><link rel="prefetch" href="/objection.js/assets/js/44.7e1ec74f.js"><link rel="prefetch" href="/objection.js/assets/js/45.63984838.js"><link rel="prefetch" href="/objection.js/assets/js/46.064524bd.js"><link rel="prefetch" href="/objection.js/assets/js/47.ab004518.js"><link rel="prefetch" href="/objection.js/assets/js/48.c7862da0.js"><link rel="prefetch" href="/objection.js/assets/js/49.3daa6199.js"><link rel="prefetch" href="/objection.js/assets/js/50.fa5a2dd4.js"><link rel="prefetch" href="/objection.js/assets/js/51.95f37a23.js"><link rel="prefetch" href="/objection.js/assets/js/6.b7dcf886.js"><link rel="prefetch" href="/objection.js/assets/js/7.1bd89ba3.js"><link rel="prefetch" href="/objection.js/assets/js/8.13201fc0.js"><link rel="prefetch" href="/objection.js/assets/js/9.7c9786ad.js"><link rel="prefetch" href="/objection.js/assets/js/vendors~docsearch.22f43628.js">
    <link rel="stylesheet" href="/objection.js/assets/css/0.styles.887cf860.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/objection.js/" class="home-link router-link-active"><!----> <span class="site-name">Objection.js</span></a> <div class="links" style="max-width:nullpx;"><form id="search-form" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/objection.js/guide/" class="nav-link">Guide</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">API Reference</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/objection.js/api/objection/" class="nav-link">Main Module</a></li><li class="dropdown-item"><!----> <a href="/objection.js/api/query-builder/" class="nav-link router-link-active">Query Builder</a></li><li class="dropdown-item"><!----> <a href="/objection.js/api/model/" class="nav-link">Model</a></li><li class="dropdown-item"><!----> <a href="/objection.js/api/types/" class="nav-link">Types</a></li></ul></div></div><div class="nav-item"><a href="/objection.js/recipes/" class="nav-link">Recipe Book</a></div><div class="nav-item"><a href="/objection.js/changelog/" class="nav-link">Changelog</a></div><div class="nav-item"><a href="https://github.com/vincit/objection.js" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ⭐ Star
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/vincit/objection.js" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/objection.js/guide/" class="nav-link">Guide</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">API Reference</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/objection.js/api/objection/" class="nav-link">Main Module</a></li><li class="dropdown-item"><!----> <a href="/objection.js/api/query-builder/" class="nav-link router-link-active">Query Builder</a></li><li class="dropdown-item"><!----> <a href="/objection.js/api/model/" class="nav-link">Model</a></li><li class="dropdown-item"><!----> <a href="/objection.js/api/types/" class="nav-link">Types</a></li></ul></div></div><div class="nav-item"><a href="/objection.js/recipes/" class="nav-link">Recipe Book</a></div><div class="nav-item"><a href="/objection.js/changelog/" class="nav-link">Changelog</a></div><div class="nav-item"><a href="https://github.com/vincit/objection.js" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ⭐ Star
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/vincit/objection.js" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Query Builder API Reference</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/objection.js/api/query-builder/find-methods.html" class="sidebar-link">Find Methods</a></li><li><a href="/objection.js/api/query-builder/mutate-methods.html" class="sidebar-link">Mutating Methods</a></li><li><a href="/objection.js/api/query-builder/eager-methods.html" class="active sidebar-link">Eager Methods</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/eager-methods.html#eager" class="sidebar-link">eager()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/eager-methods.html#eageralgorithm" class="sidebar-link">eagerAlgorithm()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/eager-methods.html#eageroptions" class="sidebar-link">eagerOptions()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/eager-methods.html#joineager" class="sidebar-link">joinEager()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/eager-methods.html#naiveeager" class="sidebar-link">naiveEager()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/eager-methods.html#mergeeager" class="sidebar-link">mergeEager()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/eager-methods.html#mergejoineager" class="sidebar-link">mergeJoinEager()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/eager-methods.html#mergenaiveeager" class="sidebar-link">mergeNaiveEager()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/eager-methods.html#eagerobject" class="sidebar-link">eagerObject()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/eager-methods.html#eagermodifiers" class="sidebar-link">eagerModifiers()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/eager-methods.html#alloweager" class="sidebar-link">allowEager()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/eager-methods.html#mergealloweager" class="sidebar-link">mergeAllowEager()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/eager-methods.html#modifyeager" class="sidebar-link">modifyEager()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/eager-methods.html#filtereager" class="sidebar-link">filterEager()</a></li></ul></li><li><a href="/objection.js/api/query-builder/join-methods.html" class="sidebar-link">Join Methods</a></li><li><a href="/objection.js/api/query-builder/other-methods.html" class="sidebar-link">Other Methods</a></li><li><a href="/objection.js/api/query-builder/static-methods.html" class="sidebar-link">Static Methods</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="eager-methods"><a href="#eager-methods" aria-hidden="true" class="header-anchor">#</a> Eager Methods</h1> <h2 id="eager"><a href="#eager" aria-hidden="true" class="header-anchor">#</a> eager()</h2> <div class="language-js extra-class"><pre class="language-js"><code>queryBuilder <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">eager</span><span class="token punctuation">(</span>relationExpression<span class="token punctuation">,</span> modifiers<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Fetch relations eagerly for the result rows.</p> <p>See the <a href="/objection.js/guide/query-examples.html#eager-loading">eager loading</a> section for more examples and <a href="/objection.js/api/types/#type-relationexpression">RelationExpression</a> for more info on the relation expression language.</p> <p>You can choose the way objection performs the eager loading by using <a href="/objection.js/api/query-builder/eager-methods.html#eageralgorithm">eagerAlgorithm</a> method on a query builder or by setting the <a href="/objection.js/api/model/static-properties.html#static-defaulteageralgorithm">defaultEagerAlgorithm</a> property of a model. The three algorithms currently available are <code>Model.WhereInEagerAlgorithm</code> (the default) <code>Model.JoinEagerAlgorithm</code> and <code>Model.NaiveEagerAlgorithm</code>. All three have their strengths and weaknesses. We will go through the main differences below. You can always see the executed SQL by calling the <a href="/objection.js/api/query-builder/other-methods.html#debug">debug</a> method for the query builder.</p> <p><b>WhereInEagerAlgorithm</b></p> <p>This algorithm uses multiple queries to fetch the related objects. Objection performs one query per level in the eager tree. For example only two additional queries will be created for eager expression <code>children.children</code> no matter how many children the model has or how many children each of the children have. This algorithm is explained in detail in <a href="https://www.vincit.fi/en/blog/nested-eager-loading-and-inserts-with-objection-js/" target="_blank" rel="noopener noreferrer">this blog post<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>Limitations:</p> <ul><li>Relations cannot be referred in the query because they are not joined.</li> <li><code>limit</code> and <code>page</code> methods will work incorrectly when applied to a relation using <code>modifyEager</code>, because they will be applied on a query that fetches relations for multiple parents. You can use <code>limit</code> and <code>page</code> for the root query.</li></ul> <p><b>JoinEagerAlgorithm</b></p> <p>This algorithm uses joins to fetch the whole eager tree using one single query. This allows you to reference the relations in the root query (see the last example). The related tables can be referred using the relation name. Nested relations must be separated by <code>:</code> character (dot is not used because of the way knex parses identifiers).</p> <p>When this algorithm is used, information schema queries are executed to get table column names. They are done only once for each table during the lifetime of the process and then cached.</p> <p>Limitations:</p> <ul><li><code>limit</code> and <code>page</code> methods will work incorrectly because they will limit the result set that contains all the result rows in a flattened format. For example the result set of the eager expression <code>children.children</code> will have <code>10 * 10 * 10</code> rows assuming the you fetched 10 models that all had 10 children that all had 10 children.</li></ul> <p><b>NaiveEagerAlgorithm</b></p> <p>This algorithm naively fetches the relations using a separate query for each model. For example relation expression <code>children.children</code> will cause 111 queries to be performed assuming a result set of 10 each having 10 children each having 10 children. For small result sets this doesn't matter. The clear benefit of this algorithm is that there are no limitations. You can use <code>offset</code>, <code>limit</code>, <code>min</code>, <code>max</code> etc. in <code>modifyEager</code>. You can for example fetch only the youngest child for each parent.</p> <p><b>Performance differences</b></p> <p><code>WhereInEagerAlgorithm</code> performs more queries than <code>JoinEagerAlgorithm</code> which can cause a significant delay especially if the round trip time to the database server is significant. On the other hand the result from <code>WhereInEagerAlgorithm</code> is trivial to parse into a tree structure while the result of <code>JoinEagerAlgorithm</code> needs some complex parsing which can lead to a significant performance decrease. Which method is faster depends heavily on the query and the environment. You should select the algorithm that makes your code cleaner and only consider performance if you have an actual measured real-life problem. Don't optimize prematurely! <code>NaiveEagerAlgorithm</code> is by far the slowest. It should only be used for
cases where performance doesn't matter and when it is the only option to get the job done.</p> <h5 id="arguments"><a href="#arguments" aria-hidden="true" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>relationExpression</td> <td><a href="/objection.js/api/types/#type-relationexpression">RelationExpression</a></td> <td>The eager expression</td></tr> <tr><td>modifiers</td> <td>Object&lt;string, function(<a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a>)&gt;</td> <td>The modifier functions for the expression</td></tr></tbody></table> <h5 id="return-value"><a href="#return-value" aria-hidden="true" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a></td> <td><code>this</code> query builder for chaining.</td></tr></tbody></table> <h5 id="examples"><a href="#examples" aria-hidden="true" class="header-anchor">#</a> Examples</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Fetch `children` relation for each result Person and `pets` and `movies`</span>
<span class="token comment">// relations for all the children.</span>
<span class="token keyword">const</span> people <span class="token operator">=</span> <span class="token keyword">await</span> Person
  <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">eager</span><span class="token punctuation">(</span><span class="token string">'children.[pets, movies]'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>people<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pets<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>people<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>movies<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Relations can be modified by giving modifier functions as arguments to the relations:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> people <span class="token operator">=</span> <span class="token keyword">await</span> Person
  <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">eager</span><span class="token punctuation">(</span><span class="token string">'children(selectNameAndId).[pets(onlyDogs, orderByName), movies]'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">selectNameAndId</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">builder</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      builder<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">orderByName</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">builder</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      builder<span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">onlyDogs</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">builder</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      builder<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'species'</span><span class="token punctuation">,</span> <span class="token string">'dog'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>people<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pets<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
cconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>people<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>movies<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Reusable modifiers can be defined for a model class using <a href="/objection.js/api/model/static-properties.html#static-modifiers">modifiers</a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token keyword">get</span> <span class="token function">modifiers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token function">defaultSelects</span><span class="token punctuation">(</span><span class="token parameter">builder</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        builder<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'firstName'</span><span class="token punctuation">,</span> <span class="token string">'lastName'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>

      <span class="token function">orderByAge</span><span class="token punctuation">(</span><span class="token parameter">builder</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        builder<span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Animal</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token keyword">get</span> <span class="token function">modifiers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token function">orderByName</span><span class="token punctuation">(</span><span class="token parameter">builder</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        builder<span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>

      <span class="token function">onlyDogs</span><span class="token punctuation">(</span><span class="token parameter">builder</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        builder<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'species'</span><span class="token punctuation">,</span> <span class="token string">'dog'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> people <span class="token operator">=</span> <span class="token keyword">await</span> Person
  <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">eager</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`
    children(defaultSelects, orderByAge).[
      pets(onlyDogs, orderByName),
      movies
    ]
  `</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>people<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pets<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>people<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>movies<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Filters can also be registered using the <a href="/objection.js/api/query-builder/other-methods.html#modifyeager">modifyEager</a> method:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> people <span class="token operator">=</span> <span class="token keyword">await</span> Person
  <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">eager</span><span class="token punctuation">(</span><span class="token string">'children.[pets, movies]'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">modifyEager</span><span class="token punctuation">(</span><span class="token string">'children'</span><span class="token punctuation">,</span> <span class="token parameter">builder</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// Order children by age and only select id.</span>
    builder<span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">modifyEager</span><span class="token punctuation">(</span><span class="token string">'children.[pets, movies]'</span><span class="token punctuation">,</span> <span class="token parameter">builder</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// Only select `pets` and `movies` whose id &gt; 10 for the children.</span>
    builder<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'&gt;'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">modifyEager</span><span class="token punctuation">(</span><span class="token string">'children.movies]'</span><span class="token punctuation">,</span> <span class="token parameter">builder</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// Only select 100 first movies for the children.</span>
    builder<span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>people<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pets<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>people<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>movies<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Relations can be given aliases using the <code>as</code> keyword:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> people <span class="token operator">=</span> <span class="token keyword">await</span> Person
  <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">eager</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`[
    children(orderByAge) as kids .[
      pets(filterDogs) as dogs,
      pets(filterCats) as cats

      movies.[
        actors
      ]
    ]
  ]`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>people<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>kids<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dogs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>people<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>kids<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>movies<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The eager queries are optimized to avoid the N + 1 query problem. Consider this query:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> people <span class="token operator">=</span> <span class="token keyword">await</span> Person
  <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">eager</span><span class="token punctuation">(</span><span class="token string">'children.children'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>people<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>children<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// --&gt; 10</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>people<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">.</span>children<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// --&gt; 10</span>
</code></pre></div><p>The person has 10 children and they all have 10 children. The query above will return 100 database rows but will generate only three database queries when using <code>WhereInEagerAlgorithm</code> and only one query when using <code>JoinEagerAlgorithm</code>.</p> <p>The loading algorithm can be changed using the <a href="/objection.js/api/query-builder/eager-methods.html#eageralgorithm">eagerAlgorithm</a> method:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> people <span class="token operator">=</span> <span class="token keyword">await</span> Person
  <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">eagerAlgorithm</span><span class="token punctuation">(</span>Person<span class="token punctuation">.</span>JoinEagerAlgorithm<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">eager</span><span class="token punctuation">(</span><span class="token string">'[movies, children.pets]'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'movies.name'</span><span class="token punctuation">,</span> <span class="token string">'like'</span><span class="token punctuation">,</span> <span class="token string">'%terminator%'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'children:pets.species'</span><span class="token punctuation">,</span> <span class="token string">'dog'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>people<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="eageralgorithm"><a href="#eageralgorithm" aria-hidden="true" class="header-anchor">#</a> eagerAlgorithm()</h2> <div class="language-js extra-class"><pre class="language-js"><code>queryBuilder <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">eagerAlgorithm</span><span class="token punctuation">(</span>algo<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Select the eager loading algorithm for the query. See comparison between
the available algorithms <a href="/objection.js/api/query-builder/eager-methods.html#eager">here</a>.</p> <h5 id="arguments-2"><a href="#arguments-2" aria-hidden="true" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>algo</td> <td>EagerAlgorithm</td> <td>The eager loading algorithm to use. One of <code>Model.JoinEagerAlgorithm</code>, <code>Model.WhereInEagerAlgorithm</code> and <code>Model.NaiveEagerAlgorithm</code>.</td></tr></tbody></table> <h5 id="return-value-2"><a href="#return-value-2" aria-hidden="true" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a></td> <td><code>this</code> query builder for chaining.</td></tr></tbody></table> <h5 id="examples-2"><a href="#examples-2" aria-hidden="true" class="header-anchor">#</a> Examples</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> people <span class="token operator">=</span> <span class="token keyword">await</span> Person
  <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">eagerAlgorithm</span><span class="token punctuation">(</span>Person<span class="token punctuation">.</span>JoinEagerAlgorithm<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">eager</span><span class="token punctuation">(</span><span class="token string">'[pets, children]'</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="eageroptions"><a href="#eageroptions" aria-hidden="true" class="header-anchor">#</a> eagerOptions()</h2> <div class="language-js extra-class"><pre class="language-js"><code>queryBuilder <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">eagerOptions</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Sets <a href="/objection.js/api/types/#type-eageroptions">options</a> for the eager query.</p> <h5 id="arguments-3"><a href="#arguments-3" aria-hidden="true" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>options</td> <td><a href="/objection.js/api/types/#type-eageroptions">EagerOptions</a></td> <td>Options to set.</td></tr></tbody></table> <h5 id="return-value-3"><a href="#return-value-3" aria-hidden="true" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a></td> <td><code>this</code> query builder for chaining.</td></tr></tbody></table> <h5 id="examples-3"><a href="#examples-3" aria-hidden="true" class="header-anchor">#</a> Examples</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> people <span class="token operator">=</span> <span class="token keyword">await</span> Person
  <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">eagerOptions</span><span class="token punctuation">(</span><span class="token punctuation">{</span>joinOperation<span class="token punctuation">:</span> <span class="token string">'innerJoin'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">eager</span><span class="token punctuation">(</span><span class="token string">'[pets, children]'</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="joineager"><a href="#joineager" aria-hidden="true" class="header-anchor">#</a> joinEager()</h2> <div class="language-js extra-class"><pre class="language-js"><code>queryBuilder <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">joinEager</span><span class="token punctuation">(</span>expr<span class="token punctuation">,</span> modifiers<span class="token punctuation">)</span>
</code></pre></div><p>Shorthand for</p> <div class="language-js extra-class"><pre class="language-js"><code>queryBuilder
  <span class="token punctuation">.</span><span class="token function">eagerAlgorithm</span><span class="token punctuation">(</span>Model<span class="token punctuation">.</span>JoinEagerAlgorithm<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">eager</span><span class="token punctuation">(</span>expr<span class="token punctuation">,</span> modifiers<span class="token punctuation">)</span>
</code></pre></div><p>When this algorithm is used, information schema queries are executed to get table column names. They are done only once for each table during the lifetime of the process and then cached.</p> <h2 id="naiveeager"><a href="#naiveeager" aria-hidden="true" class="header-anchor">#</a> naiveEager()</h2> <div class="language-js extra-class"><pre class="language-js"><code>queryBuilder <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">naiveEager</span><span class="token punctuation">(</span>expr<span class="token punctuation">,</span> modifiers<span class="token punctuation">)</span>
</code></pre></div><p>Shorthand for</p> <div class="language-js extra-class"><pre class="language-js"><code>queryBuilder
  <span class="token punctuation">.</span><span class="token function">eagerAlgorithm</span><span class="token punctuation">(</span>Model<span class="token punctuation">.</span>NaiveEagerAlgorithm<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">eager</span><span class="token punctuation">(</span>expr<span class="token punctuation">,</span> modifiers<span class="token punctuation">)</span>
</code></pre></div><h2 id="mergeeager"><a href="#mergeeager" aria-hidden="true" class="header-anchor">#</a> mergeEager()</h2> <p>Just like <a href="/objection.js/api/query-builder/eager-methods.html#eager">eager</a> but instead of replacing query builder's eager expression this method merges the given expression to the existing expression.</p> <h5 id="arguments-4"><a href="#arguments-4" aria-hidden="true" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>relationExpression</td> <td><a href="/objection.js/api/types/#type-relationexpression">RelationExpression</a></td> <td>The eager expression</td></tr> <tr><td>modifiers</td> <td>Object&lt;string, function(<a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a>)&gt;</td> <td>The modifier functions for the expression</td></tr></tbody></table> <h5 id="return-value-4"><a href="#return-value-4" aria-hidden="true" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a></td> <td><code>this</code> query builder for chaining.</td></tr></tbody></table> <h5 id="examples-4"><a href="#examples-4" aria-hidden="true" class="header-anchor">#</a> Examples</h5> <p>The following queries are equivalent</p> <div class="language-js extra-class"><pre class="language-js"><code>Person
  <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">eager</span><span class="token punctuation">(</span><span class="token string">'[children.pets, movies]'</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>Person
  <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">eager</span><span class="token punctuation">(</span><span class="token string">'children'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">mergeEager</span><span class="token punctuation">(</span><span class="token string">'children.pets'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">mergeEager</span><span class="token punctuation">(</span><span class="token string">'movies'</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>Person
  <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">eager</span><span class="token punctuation">(</span><span class="token string">'children.pets'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">mergeEager</span><span class="token punctuation">(</span><span class="token string">'movies'</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>Person
  <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">mergeEager</span><span class="token punctuation">(</span><span class="token string">'children.pets'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">mergeEager</span><span class="token punctuation">(</span><span class="token string">'movies'</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="mergejoineager"><a href="#mergejoineager" aria-hidden="true" class="header-anchor">#</a> mergeJoinEager()</h2> <p>Shorthand for <code>eagerAlgorithm(Model.JoinEagerAlgorithm).mergeEager(expr)</code>.</p> <h2 id="mergenaiveeager"><a href="#mergenaiveeager" aria-hidden="true" class="header-anchor">#</a> mergeNaiveEager()</h2> <p>Shorthand for <code>eagerAlgorithm(Model.NaiveEagerAlgorithm).mergeEager(expr)</code>.</p> <h2 id="eagerobject"><a href="#eagerobject" aria-hidden="true" class="header-anchor">#</a> eagerObject()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> builder <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">eager</span><span class="token punctuation">(</span><span class="token string">'children.pets(onlyId)'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> eagerObject <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">eagerObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>eagerObject<span class="token punctuation">.</span>children<span class="token punctuation">.</span>pets<span class="token punctuation">.</span>modify<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// prints [&quot;onlyId&quot;]</span>

eagerObject<span class="token punctuation">.</span>children<span class="token punctuation">.</span>movies <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token comment">// You can modify the object and pass it back to the `eager` method.</span>
builder<span class="token punctuation">.</span><span class="token function">eager</span><span class="token punctuation">(</span>eagerObject<span class="token punctuation">)</span>
</code></pre></div><p>Returns the object representation of the current eager expression.</p> <p>See <a href="/objection.js/api/types/#relationexpression-object-notation">this section</a> for more examples and information about the structure of the returned object.</p> <h5 id="return-value-5"><a href="#return-value-5" aria-hidden="true" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>object</td> <td>Object representation of the current eager expression.</td></tr></tbody></table> <h2 id="eagermodifiers"><a href="#eagermodifiers" aria-hidden="true" class="header-anchor">#</a> eagerModifiers()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> builder <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">eager</span><span class="token punctuation">(</span><span class="token string">'children.pets(onlyId)'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    onlyId<span class="token punctuation">:</span> builder<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> modifiers <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">eagerModifiers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>modifiers<span class="token punctuation">.</span>onlyId<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// prints 'builder =&gt; builder.select(&quot;id&quot;)'</span>
</code></pre></div><p>Returns the current eager modifiers of the query.</p> <h5 id="return-value-6"><a href="#return-value-6" aria-hidden="true" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>object</td> <td>Eager modifiers of the query.</td></tr></tbody></table> <h2 id="alloweager"><a href="#alloweager" aria-hidden="true" class="header-anchor">#</a> allowEager()</h2> <div class="language-js extra-class"><pre class="language-js"><code>queryBuilder <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">allowEager</span><span class="token punctuation">(</span>relationExpression<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Sets the allowed eager expression.</p> <p>Any subset of the allowed expression is accepted by <a href="/objection.js/api/query-builder/eager-methods.html#eager">eager</a> method. For example setting the allowed expression to <code>a.b.c</code> expressions <code>a</code>, <code>a.b</code> and <code>a.b.c</code> are accepted by <a href="/objection.js/api/query-builder/eager-methods.html#eager">eager</a> method. Setting any other expression will reject the query and cause the promise error handlers to be called.</p> <p>This method is useful when the eager expression comes from an untrusted source like query parameters of a http request.</p> <h5 id="arguments-5"><a href="#arguments-5" aria-hidden="true" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>relationExpression</td> <td><a href="/objection.js/api/types/#type-relationexpression">RelationExpression</a></td> <td>The allowed eager expression</td></tr></tbody></table> <h5 id="return-value-7"><a href="#return-value-7" aria-hidden="true" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a></td> <td><code>this</code> query builder for chaining.</td></tr></tbody></table> <h5 id="examples-5"><a href="#examples-5" aria-hidden="true" class="header-anchor">#</a> Examples</h5> <div class="language-js extra-class"><pre class="language-js"><code>Person
  <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">allowEager</span><span class="token punctuation">(</span><span class="token string">'[children.pets, movies]'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">eager</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>eager<span class="token punctuation">)</span>
</code></pre></div><h2 id="mergealloweager"><a href="#mergealloweager" aria-hidden="true" class="header-anchor">#</a> mergeAllowEager()</h2> <p>Just like <a href="/objection.js/api/query-builder/eager-methods.html#alloweager">allowEager</a> but instead of replacing query builder's allowEager expression this method merges the given expression to the existing expression.</p> <h5 id="arguments-6"><a href="#arguments-6" aria-hidden="true" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>relationExpression</td> <td><a href="/objection.js/api/types/#type-relationexpression">RelationExpression</a></td> <td>The allowed eager expression</td></tr></tbody></table> <h5 id="return-value-8"><a href="#return-value-8" aria-hidden="true" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a></td> <td><code>this</code> query builder for chaining.</td></tr></tbody></table> <h5 id="examples-6"><a href="#examples-6" aria-hidden="true" class="header-anchor">#</a> Examples</h5> <p>The following queries are equivalent</p> <div class="language-js extra-class"><pre class="language-js"><code>Person
  <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">allowEager</span><span class="token punctuation">(</span><span class="token string">'[children.pets, movies]'</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>Person
  <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">allowEager</span><span class="token punctuation">(</span><span class="token string">'children'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">mergeAllowEager</span><span class="token punctuation">(</span><span class="token string">'children.pets'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">mergeAllowEager</span><span class="token punctuation">(</span><span class="token string">'movies'</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>Person
  <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">allowEager</span><span class="token punctuation">(</span><span class="token string">'children.pets'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">mergeAllowEager</span><span class="token punctuation">(</span><span class="token string">'movies'</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>Person
  <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">mergeAllowEager</span><span class="token punctuation">(</span><span class="token string">'children.pets'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">mergeAllowEager</span><span class="token punctuation">(</span><span class="token string">'movies'</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="modifyeager"><a href="#modifyeager" aria-hidden="true" class="header-anchor">#</a> modifyEager()</h2> <div class="language-js extra-class"><pre class="language-js"><code>queryBuilder <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">modifyEager</span><span class="token punctuation">(</span>pathExpression<span class="token punctuation">,</span> modifier<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Can be used to modify eager queries.</p> <p>The <code>pathExpression</code> is a relation expression that specifies the queries for which the modifier is given.</p> <p>The following query would filter out the children's pets that are &lt;= 10 years old:</p> <h5 id="arguments-7"><a href="#arguments-7" aria-hidden="true" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>pathExpression</td> <td><a href="/objection.js/api/types/#type-relationexpression">RelationExpression</a></td> <td>Expression that specifies the queries for which to give the filter.</td></tr> <tr><td>modifier</td> <td>function(<a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a> | string | string[]</td> <td>A modifier function, <a href="/objection.js/api/model/static-properties.html#static-modifiers">model modifier</a> name or an array of model modifier names.</td></tr></tbody></table> <h5 id="return-value-9"><a href="#return-value-9" aria-hidden="true" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a></td> <td><code>this</code> query builder for chaining.</td></tr></tbody></table> <h5 id="examples-7"><a href="#examples-7" aria-hidden="true" class="header-anchor">#</a> Examples</h5> <div class="language-js extra-class"><pre class="language-js"><code>Person
  <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">eager</span><span class="token punctuation">(</span><span class="token string">'[children.[pets, movies], movies]'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">modifyEager</span><span class="token punctuation">(</span><span class="token string">'children.pets'</span><span class="token punctuation">,</span> <span class="token parameter">builder</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    builder<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'&gt;'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>The path expression can have multiple targets. The next example sorts both the pets and movies of the children by id:</p> <div class="language-js extra-class"><pre class="language-js"><code>Person
  <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">eager</span><span class="token punctuation">(</span><span class="token string">'[children.[pets, movies], movies]'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">modifyEager</span><span class="token punctuation">(</span><span class="token string">'children.[pets, movies]'</span><span class="token punctuation">,</span> <span class="token parameter">builder</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    builder<span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>This example only selects movies whose name contains the word 'Predator':</p> <div class="language-js extra-class"><pre class="language-js"><code>Person
  <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">eager</span><span class="token punctuation">(</span><span class="token string">'[children.[pets, movies], movies]'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">modifyEager</span><span class="token punctuation">(</span><span class="token string">'[children.movies, movies]'</span><span class="token punctuation">,</span> <span class="token parameter">builder</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    builder<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'like'</span><span class="token punctuation">,</span> <span class="token string">'%Predator%'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>The modifier can also be a <a href="/objection.js/api/model/static-properties.html#static-modifiers">Model modifier</a> name, or an array of them:</p> <div class="language-js extra-class"><pre class="language-js"><code>Person
  <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">eager</span><span class="token punctuation">(</span><span class="token string">'[children.[pets, movies], movies]'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">modifyEager</span><span class="token punctuation">(</span><span class="token string">'children.movies'</span><span class="token punctuation">,</span> <span class="token string">'selectId'</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="filtereager"><a href="#filtereager" aria-hidden="true" class="header-anchor">#</a> filterEager()</h2> <p>Alias for <a href="/objection.js/api/query-builder/other-methods.html#modifyeager">modifyEager</a>.</p></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/objection.js/api/query-builder/mutate-methods.html" class="prev">
          Mutating Methods
        </a></span> <span class="next"><a href="/objection.js/api/query-builder/join-methods.html">
          Join Methods
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/objection.js/assets/js/app.76d7874a.js" defer></script><script src="/objection.js/assets/js/15.974b6934.js" defer></script>
  </body>
</html>
